[
  {
    "path": "posts/2022-05-22-a-brief-introduction-to-natural-hazard-risk-analysis/",
    "title": "A brief introduction to natural hazard risk analysis",
    "description": "This article is a quick guide on the basic steps involved in natural hazard risk analysis. It briefly touches on some of the most common steps:  geocoding, hazard maps, damage curves and climate projections. I demonstrate how R can be used to assess exposure of assets with a simple example on flood risk for presidential palaces around the world.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {
          "https://fbellelli.com/": {}
        }
      }
    ],
    "date": "2022-05-22",
    "categories": [
      "risk",
      "coding",
      "environment",
      "other"
    ],
    "contents": "\r\n\r\nContents\r\nFirst things first\r\nGeocoding\r\nHow to find out information on flood risk\r\nLoading hazard maps\r\nA brief note on coordinate systems\r\n\r\nExtracting flood risk information\r\nIntersecting asset location with hazard maps\r\nExtracting flood depth for multiple return periods\r\nExpected flooding levels\r\n\r\nConverting hazard distributions into expected damages\r\nDamage curves\r\nCalculating expected damages\r\n\r\nClimate change: the elephant in the room\r\n\r\n\r\n\r\n\r\nFirst things first\r\nThe fundamental prerequisite for any risk exposure assessment is to have a list of assets for which we wish to conduct the analysis. As an illustrative purpose, we can imagine we have been tasked to analyse flood risk for presidential palaces around the world. This Wikipedia page provides a list of palaces names with the name of the city and country in which they are located. I extracted, cleaned and saved the information of 143 presidential palaces in a csv file, which can be downloaded here to follow along with the example.\r\n\r\n\r\n#load list of palaces\r\npalaces <- read.csv(\"presidential_palaces_geocoded_with_risk.csv\", encoding=\"UTF-8\")\r\n\r\n\r\n\r\nGeocoding\r\nOnce we have a collection of asset, the first step is to convert addresses into latitude and longitude coordinates — this operation is known as geocoding. Geocoding is important because it gives geographic coordinates that are easily interpretable by a computer. This will allow to place our assets on a map and extract information on flood risks.\r\nGeocoding is usually performed with an API (e.g. Google maps, OpenStreetMap, …) that takes in addresses and spits out coordinates. Nowadays, these APIs require the user to provide keys in order to limit the number of requests. Here is a list of the most common packages for doing this in R:\r\nggmap\r\nnominatimlite\r\nosmdata\r\ntidygeocoder\r\nAttentive readers, might have noticed that we already provided longitude and latitudes in the example file. We got these coordinates with the following code.\r\n\r\n\r\nlibrary(ggmap)\r\n\r\n# insert personal google API key - this requires registration \r\nregister_google(key=\"WRITE YOUR KEY HERE\")\r\n\r\n#geocode addresses\r\ngeo <- geocode(paste0(palaces$Building,\", \",palaces$Country))\r\n\r\n#import geocodes in table\r\npalaces <- cbind(palaces,geo)\r\n\r\n\r\n\r\nNow that we have the coordinates of the palaces, we can easily place them on an interactive map with the package leaflet. The names of the palaces can be visualised by hovering over the markers.\r\n\r\n\r\nlibrary(leaflet)\r\n\r\nleaflet(palaces) %>%\r\n  addTiles() %>%  \r\n  addMarkers(lng= ~ lon, lat= ~ lat, label= ~ Building)\r\n\r\n\r\n\r\n{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[[36.7535686,6.3702928,-24.6521557,3.8480325,-4.2833186,5.3599517,6.8276228,11.5720765,30.0432148,30.0888643,30.09813,15.3355689,8.9806034,0.3921138,5.5797341,11.8638703,-1.282819,-19.0033026,-18.8791902,-13.9631425,12.6580318,18.0947803,-22.591141,9.0622697,-1.9393852,0.2602568,14.716677,2.041022,9.562389,-25.7378419,4.859363,15.5006544,36.844501,0.3208331,0.0511839,-15.428921,-17.8216288,-34.6080556,-34.515,13.1012,-16.4967711,-15.7990489,-33.4429091,4.5954066,9.9227382,23.1135925,23.1206272,15.414999,-0.219716,13.6851216,14.6426439,18.5430982,14.0887349,19.4324451,12.1149926,-25.2772267,-12.0448456,5.826814,10.677646,38.8976763,-34.9072255,-34.8601987,10.5080483,10.4878059,34.525212,40.1872023,40.4092617,23.7233727,39.904211,35.155663,-8.555501,28.6177247,17.5046669,31.1139028,-6.170131,-6.2087634,-6.7336086,-6.5980046,-7.8001506,-8.4149206,35.8161559,33.315241,31.7763078,51.1257401,37.5866076,39.1163434,39.063236,42.8772492,42.8822707,17.9624484,33.8417455,47.92075,19.7633057,27.7172453,33.732222,31.952162,14.5946001,1.3067039,7.263889,33.5176726,33.5188937,25.0399991,38.5766538,38.963745,37.9316011,41.2994958,40.116667,41.3583502,21.0392942,15.3694451,41.3189,48.2056578,53.9006011,43.8578928,42.6970493,45.837778,50.0910966,50.1239183,60.1683906,48.8697906,52.5175726,50.7227846,41.6956973,37.9727877,47.4978589,53.3596862,41.8996484,56.9509516,54.6832231,41.985771,35.8964431,35.8614473,47.0104529,52.243168,52.2131463,44.4345086,55.7505944,55.753038,44.8098391,48.149138,46.0490152,39.9308873,50.4483553],[3.0425182,2.3912362,25.9143093,11.5020752,15.2649343,-4.0082563,-5.2893433,43.1456475,31.247217,31.3193929,31.3041176,38.9308357,38.7577605,9.4426136,-0.1884806,-15.5849111,36.8000221,47.5285396,47.5079055,33.851701,-8.0112381,-15.9707222,17.100912,7.5185333,30.0836323,6.6210611,-17.4676861,45.336775,44.0770134,28.226743,31.57125,32.5598994,10.1993064,32.5804497,32.463708,28.3276983,31.0492259,-58.3702778,-58.483056,-59.5996,-68.1339357,-47.8607689,-70.6538699,-74.0775852,-84.0558275,-82.3665956,-82.38729,-61.370976,-78.5126074,-89.2398936,-90.5131097,-72.3388888,-87.1878363,-99.131193,-86.2361744,-57.6372439,-77.0297865,-55.151245,-61.511979,-77.0365298,-56.2001356,-56.1970177,-66.9193333,-66.8338841,69.1767397,44.515209,49.8670924,90.4180883,116.407395,33.3472557,125.5630338,77.1975612,78.5217595,77.2477895,106.8241607,106.845599,107.0410991,106.7974666,110.3637507,115.3109393,51.4240378,44.3660671,35.2128566,71.4463504,126.974811,125.8058622,125.7891197,74.6002389,74.5618441,102.6101184,35.5394954,106.917306,96.0785104,85.3239605,73.098333,35.233154,120.9946065,103.8431002,80.640278,36.2518981,36.2622372,121.5119507,68.7784685,35.243322,58.3841512,69.2400734,64.566667,69.3998445,105.834498,44.1910066,19.82,16.3647803,27.558972,18.4140776,23.3239639,15.958333,14.4016165,13.9562552,24.9563446,2.3164773,13.3527928,7.1172788,44.8110702,23.7408305,19.0380282,-6.3174136,12.4870235,24.1005816,25.2860246,21.4156881,14.4463108,14.4006292,28.8638103,21.0166125,21.0276429,26.0606683,37.615344,37.6190995,20.4632109,17.1077209,14.497814,32.7990765,30.5376094],null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,[\"El Mouradia, Algiers\",\"Palais de la Marina, Cotonou\",\"State House, Gaborone\",\"The Unity Palace, Yaoundé\",\"Palais du Peuple, Brazzaville\",\"Presidential Palace, Abidjan\",\"Presidential Palace, Yamoussoukro\",\"Presidential Palace, Djibouti City\",\"Abdeen Palace, Cairo\",\"Heliopolis Palace, Cairo\",\"Koubbeh Palace, Cairo\",\"Asmara President's Office, Asmara\",\"National Palace, Addis Ababa\",\"Presidential Palace, Libreville\",\"Jubilee House, Accra\",\"Presidential Palace, Bissau\",\"State House, Nairobi\",\"Iavoloha Palace, Antananarivo\",\"Ambohitsorohitra Palace, Antananarivo\",\"Kamuzu Palace, Lilongwe\",\"Presidential Palace, Bamako\",\"Presidential Palace, Nouakchott\",\"State House of Namibia, Windhoek\",\"Nigerian Presidential Complex, Abuja\",\"Urugwiro, Kigali\",\"Presidential Palace, São Tomé\",\"Presidential Palace, Dakar\",\"Villa Somalia, Mogadishu\",\"Presidential Palace, Hargeisa\",\"Mahlamba Ndlopfu, Pretoria\",\"Presidential Palace, Juba\",\"Presidential Palace, Khartoum\",\"Carthage Palace, Tunis\",\"State House, Kampala\",\"State House, Entebbe\",\"State House, Lusaka\",\"(former) Presidential Palace, Harare\",\"Casa Rosada, Buenos Aires\",\"Quinta de Olivos, Buenos Aires Province\",\"State House, Bridgetown\",\"Casa Grande del Pueblo, La Paz\",\"Palácio do Planalto, Brasilia\",\"La Moneda Palace, Santiago de Chile\",\"Casa(Palacio) de Nariño, Bogotá\",\"Casa Presidencial, San José\",\"Presidential Palace (former), Havana\",\"Palacio de la Revolucion, Havana\",\"Government House, Roseau\",\"Carondelet Palace, Quito\",\"Casa Presidencial, San Salvador\",\"National Palace, Guatemala City\",\"National Palace, Port-au-Prince\",\"Presidential Palace, Tegucigalpa\",\"National Palace\",\"Presidential Palace, Managua\",\"Palacio de los López, Asunción\",\"Government Palace, Lima\",\"Gouvernementsgebouw, Paramaribo\",\"President's House, Port of Spain\",\"White House, Washington, D.C.\",\"Executive Tower, Montevideo\",\"Residencia de Suárez, Montevideo\",\"Miraflores Palace, Caracas\",\"La Casona\",\"Arg, Kabul\",\"President's House, Yerevan\",\"Presidential Palace, Baku\",\"Bangabhaban, Dhaka\",\"Zhongnanhai, Beijing\",\"Presidential Palace, Nicosia\",\"Nicolau Lobato Presidential Palace, Dili\",\"Rashtrapati Bhavan, New Delhi\",\"Rashtrapati Nilayam, Hyderabad\",\"The Retreat Building, Shimla\",\"Istana Merdeka, Jakarta\",\"Istana Negara, Jakarta\",\"Istana Cipanas, Cipanas\",\"Istana Bogor, Bogor\",\"Gedung Agung, Yogyakarta\",\"Istana Tampaksiring, Bali\",\"Sa'dabad Palace, Tehran; Office of the Supreme Leader of Iran\",\"Radwaniyah Palace, Baghdad\",\"Beit HaNassi, Jerusalem\",\"Ak Orda Presidential Palace, Nur-Sultan\",\"Blue House, Seoul\",\"Ryongsong Residence, Pyongyang\",\"Kumsusan Palace of the Sun, Pyongyang\",\"White House, Bishkek\",\"Ala Archa State Residence, Bishkek\",\"Presidential Palace, Vientiane\",\"Baabda Palace, Beirut\",\"Government Palace, Ulan Bator\",\"Presidential Palace, Naypyidaw\",\"Rastrapati Bhawan, Kathmandu\",\"Aiwan-e-Sadr, Islamabad\",\"Mukataa\",\"Malacañang Palace, Manila\",\"Istana, Singapore\",\"President's Pavilion, Kandy\",\"Presidential Palace, Damascus\",\"Tishreen Palace, Damascus\",\"Presidential Office Building, Taipei\",\"Palace of Nations, Dushanbe\",\"Presidential Compound (Turkey)\",\"Oguzkhan Palace, Ashgabat\",\"Ok Saroy Presidential Palace, Tashkent[22]\",\"Durmen\",\"Kuksaroy Presidential Palace, Tashkent\",\"Presidential Palace, Hanoi\",\"Presidential Palace, Sanaa\",\"Presidential Palace of Tirana\",\"Hofburg Palace, Vienna\",\"Presidential Palace, Minsk\",\"Presidency Building, Sarajevo\",\"Presidential Palace, Sofia\",\"Presidential Palace, Zagreb\",\"Prague Castle, Prague\",\"The Lány Chateau, Lány\",\"Presidential Palace, Helsinki\",\"Élysée Palace, Paris\",\"Bellevue Palace, Berlin\",\"Villa Hammerschmidt, Bonn\",\"Orbeliani Presidental Palace, Tbilisi\",\"Presidential Mansion, Athens\",\"Sándor Palace, Buda\",\"Áras an Uachtaráin, Dublin\",\"Quirinal Palace, Rome\",\"Riga Castle, Riga\",\"Presidential Palace, Vilnius\",\"Villa Vodno, Skopje\",\"San Anton Palace, Attard\",\"Verdala Palace, Siġġiewi\",\"Presidential Palace, Chișinau\",\"Presidential Palace, Warsaw\",\"Belweder Palace, Warsaw\",\"Cotroceni Palace, Bucharest\",\"Grand Kremlin Palace, Moscow Kremlin\",\"Kremlin Senate,\\nMoscow Kremlin\",\"Novi Dvor, Belgrade\",\"Grassalkovich Palace, Bratislava\",\"Presidential Palace, Ljubljana\",\"Presidential Complex\",\"Mariinskyi Palace, Kyiv\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[-34.9072255,60.1683906],\"lng\":[-99.131193,126.974811]}},\"evals\":[],\"jsHooks\":[]}\r\nHow to find out information on flood risk\r\nThe goal of our analysis is to obtain information on the risk exposure of different assets. The easiest way to get it, is to refer to hazard maps. Hazard maps are maps which identify areas that are vulnerable to a particular hazard. They are built by experts based on geophysical modelling that incorporate all the main factors affecting hazard exposure. Many government agency across the world build hazard maps to manage risk in their countries. For instance, in the Unites States, the reference flood hazard map is the one from the Federal Emergency Management Agency (FEMA).\r\nLoading hazard maps\r\nIn this example, we will use the riverine flood maps from Acqueduct, which have a resolution of 30 arc second (roughly 1km at the equator). Although higher granularity may be advisable for flood assessment, Acqueduct maps have the advantages of being publicly available, having a global coverage and having projections under different climate scenarios.\r\nAcqueduct flood maps are available for different return periods (2, 5, 10, 25, …, 1000 years). Return periods are the inverse of probabilities. For instance, a 1 in 100 year flood is a flood of such intensity that it will be equalled or exceeded on average once every 100 years, i.e. a flood which has a 1% probability of occurring in a given year.\r\nFor each return period, Aqueduct’s flood map display the expected inundation depth (in meters). In other words, Aqueduct provides a set of flood map which give slices of the probability-depth joint distribution. The beautiful figure below illustrates how these maps look like. Lighter colours indicate inundated areas in the event of a 1 in 500 years flood. Understandibly, the map shows that areas around rivers are at higher risk of riverine floods and quantifies the severity of this risk in term of inundation depth.\r\n\r\n\r\n\r\nFigure 1: Aqueduct riverine historical flood map - 500 year return period\r\n\r\n\r\n\r\nAcqueduct flood maps come as raster files (.tif), in which each pixel encodes the expected inundation depth. We can use the package terra to work with this type of data in R. Let’s load the map with the following command\r\n\r\n\r\nlibrary(terra)\r\n\r\n#path to Aqueduct hazard map - riverine flooding (100 years return period) \r\nmap_path <- \"http://wri-projects.s3.amazonaws.com/AqueductFloodTool/download/v2/inunriver_historical_000000000WATCH_1980_rp00100.tif\"\r\n\r\n#load hazard map in R\r\nrflood100 <- terra::rast(map_path)\r\n\r\n\r\n\r\nNotice that vector data (e.g. .shp, GeoJSON) are also a common formats for hazard maps. In vector formats the information is attached to polygons instead of pixels. For manipulating vector spatial data, the package sf is my favourite alternative. Vector data can be loaded with the functions sf::read_sf() or terra::vect(). Vector spatial data could be the subject of another post.\r\nA brief note on coordinate systems\r\nSpatial data often comes with information on the underlying coordinate system and map projections. Computers programmes will often be able to read these information and automatically convert it as needed. However, it might occasionally be necessary to specify manually this information. For example, if we wish to indicate that our lat and long columns correspond to the latitude and longitude commonly used in the real world by GPS systems or to perform changes of coordinates for mapping.\r\nTherefire, it might be useful to know that latitude and longitude of points of assets and polygons are very often expressed in the World Geodesic System of 1984 (WGS84) and that rasterised maps normally use an equirectangular projection because this projections maps the surface of the earth onto a grid, thus it can be easily linked to the pixels of an image.\r\nThat being said, this topic is way to vast to fit in this article and my limited knowledge would not do justice to this fascinating corpus of scientific work. The issues associated with coordinate system, projections and their distortions kept bright human minds busy for centuries. I highly recommend this series of articles from the Australian and New Zealand Spatial Information Council for a wonderfully written introduction on all these mapping topics.\r\nExtracting flood risk information\r\nNow that we have hazard maps with flood risk information and geocoded asset locations, all that is left to do is to extract information for our locations of interest.\r\nIntersecting asset location with hazard maps\r\nWe can use the same package, terra, to perform this operation with one line of code. First, we declare the columns lon and lat as coordinates for the palaces position. Then, we use the function extract to extract information from the flood map for our list of presidential palaces. Finally, we save the results in the palaces table.\r\n\r\n\r\n#convert palaces into vector points\r\npalaces_vect <- terra::vect(palaces, geom=c(\"lon\",\"lat\"))\r\n\r\n#extract information for palaces\r\ntemp <- terra::extract(rflood100, palaces_vect) \r\n\r\n#save extracted information in palaces table\r\npalaces$flood <- temp[,2]\r\n\r\n\r\n\r\nCitizens around the world will be pleased to hear that most palaces around the world are not at risk of getting flooded. In the following table we list the top ten palaces in which leaders are most likely to get their feet wet in case of a 1 in a 100 year flood. Only three palaces have a flooding depth higher than 1m, which could be considered as an extreme flood.\r\n\r\nTable 1: Ten worst flooded palaces in case of a 1 in 100 year flood\r\nCountry\r\nBuilding\r\nFlood depth (m)\r\nGabon\r\nPresidential Palace, Libreville\r\n3.4\r\nSudan\r\nPresidential Palace, Khartoum\r\n2.4\r\nGermany\r\nVilla Hammerschmidt, Bonn\r\n2.3\r\nTunisia\r\nCarthage Palace, Tunis\r\n0.9\r\nPhilippines\r\nMalacañang Palace, Manila\r\n0.5\r\nSomalia\r\nVilla Somalia, Mogadishu\r\n0.3\r\nKazakhstan\r\nAk Orda Presidential Palace, Nur-Sultan\r\n0.3\r\nGermany\r\nBellevue Palace, Berlin\r\n0.2\r\nEast Timor\r\nNicolau Lobato Presidential Palace, Dili\r\n0.1\r\nDjibouti\r\nPresidential Palace, Djibouti City\r\n0.1\r\n\r\nExtracting flood depth for multiple return periods\r\nNow that we know how information can be extracted, we can repeat the procedure for different return periods so as to have a complete picture of the distribution for different flood severity. This is time-consuming step, hence, I already included the results in the example data.\r\n\r\n\r\n#convert palaces into vector points\r\npalaces_vect <- terra::vect(palaces, geom=c(\"lon\",\"lat\"))\r\n\r\n#loop over all return periods\r\nfor (i in c(\"0002\",\"0005\",\"0010\",\"0025\",\"0050\",\"0100\",\"0250\",\"0500\",\"1000\")){\r\n  \r\n  # prepare path to hazard map\r\n  map_path <- paste0(\"http://wri-projects.s3.amazonaws.com/AqueductFloodTool/download/v2/inunriver_historical_000000000WATCH_1980_rp0\",i,\".tif\")\r\n\r\n  #load map  \r\n  flood <- terra::rast(map_path)\r\n  \r\n  #extract information\r\n  temp <- terra::extract(flood, palaces_vect)\r\n  \r\n  #save information in palaces table\r\n  palaces[,paste0(\"flood\",i)] <- temp[,2]\r\n}\r\n\r\n\r\n\r\nHaving the full distribution of probability-depth of flooding allows to make some interesting comparisons. The next graph shows the risk profile of the three properties with the highest flooding risk.\r\nWe can see that Villa Hammerschmidt (Bonn) has 10% (1/10 yr) probability of having a 1 meter flood, while the presidential palaces in Karthoum has around 3% (1/33 yr) of experiencing a flood with similar depth levels.\r\nOverall, it appears that Villa Hammerschmidt (Bonn) is more likely to get flooded regularly, while the presidential palace in Karthoum has lower flood probabilities, but it has higher expected flood depth in case of extreme floods (1 in 100 year or higher). Finally the presidential palace in Libreville has higher expected flooding levels for all return periods.\r\n\r\n\r\n\r\nFigure 2: Probability-depth distribution for the three most exposed palaces\r\n\r\n\r\n\r\nExpected flooding levels\r\nHaving the full probability-severity distribution allows for a greater richness of details. However, sometimes it is handy to have a single metric that encapsulates the risk profile of an asset. To do this, we can calculate the annualised expected flood level by summing over the flood depths weighted by their probabilities (inverse of return period).\r\n\\[ \r\nE[\\text{Flooding}]_i = \\sum^{n}_{j=1}\\frac{1}{RP_{j}}\\cdot Depth_{ij}\r\n\\]\r\nWhere, \\(i\\) is an index for the asset and \\(j\\) an index for the \\(n\\) available return periods. So that \\(RP_{j}\\) indicates the return period associated with the \\(j\\)-th index and \\(Depth_{ij}\\) indicates the depth level expected for asset \\(i\\) with return period \\(RP_{j}\\). We can implement this calculation in R by using the dplyrand tidyrpackages.\r\n\r\n\r\nlibrary(dplyr)\r\nlibrary(tidyr)\r\n\r\n#tidying up the table into a long format (this facilitates calculations in R)\r\nlong_table <- palaces %>%\r\n  pivot_longer(cols=starts_with(\"flood\"),\r\n               names_to = \"return_period\",\r\n               values_to = \"flood_depth\") %>%\r\n  mutate(return_period = as.numeric(substr(return_period, 6,10)))\r\n\r\n#calculating the expected flood level\r\nrisk_table <- long_table %>%\r\n  mutate(probability = 1/return_period,\r\n         expected_flood = probability * flood_depth) %>%\r\n  group_by(Building) %>%\r\n  summarise(expected_flood = sum(expected_flood), .groups=\"drop\")\r\n\r\n\r\n\r\nWe can then rank the palaces according to this metric. We find that the Presidential palace in Libreville and the Villa Hammerschmidt (Bonn) are the palaces at greater risk of riverine flooding in our sample. It is plausible that these palaces are at high flood risk, the presidential palace in Libreville is located just next to the sea, and villa Hammerschmidt is built on the shores of the Rhine, as shown in the map below. However, the depth levels seems suspiciously high, it would be advisable to use alternative maps (possibly with higher granularity) to double-check these numbers. Perhaps the map used here do not take into account flood defences that were built to prevent regular flooding.\r\n\r\nTable 2: The ten palaces at highest flooding risk\r\nBulding\r\nAnnualised expected flood level (cm)\r\nPresidential Palace, Libreville\r\n53\r\nVilla Hammerschmidt, Bonn\r\n38\r\nPresidential Palace, Khartoum\r\n11\r\nCarthage Palace, Tunis\r\n10\r\nVilla Somalia, Mogadishu\r\n6\r\nAk Orda Presidential Palace, Nur-Sultan\r\n5\r\nMalacañang Palace, Manila\r\n5\r\nBellevue Palace, Berlin\r\n4\r\nNicolau Lobato Presidential Palace, Dili\r\n2\r\nPresidential Palace, Djibouti City\r\n2\r\n\r\n\r\n\r\n{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[50.7227846,7.1172788,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,\"Villa Hammerschmidt, Bonn\",{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[50.7227846,50.7227846],\"lng\":[7.1172788,7.1172788]}},\"evals\":[],\"jsHooks\":[]}\r\nConverting hazard distributions into expected damages\r\nSo far, the analysis has concentrated on quantifying the exposure to physical risks. Next, we might want to convert this exposure into expected damages to our assets. Damage curves are the standard tool applied to achieve this.\r\nDamage curves\r\nDamage curves, also vulnerability functions, are curves mapping the intensity of an hazard to the expected damage to an asset, which is typically expressed as a damage ratio — i.e. percentage of asset construction value that is lost. These curves are usually estimated from historical damage data.\r\nThe actual damage incurred by an asset will depend on a multitude of factors. For example, in the case of a riverine flood, we can immagine that the presence of basement, the height of the house floor, number of floors, materials, construction methods, whether preventive measure have been taken, etc., are all factors that will modify the impact of flooding on the property.\r\nTherefore, there is no there is no universal damage curve that can be applied to all types of assets. Usually, different damage curves are devised according to key characteristics of the assets, such as material, construction techniques, positioning, orientation, shape, height, layout, number of windows, etc. This will allow to get a more accurate estimate of the effective hazard damages.\r\nNevertheless, for the sake of this example, let’s keep things simple and assume a unique damage curve is representative for all presidential palaces. We will take an average damage curves without worrying too much about construction specifications. In the figure below, I plotted average damages curves developed in this research paper of the JRC (European Commission) for different regions of the World. If you wish to download the curves used in this example, a cleaned version of the data is availablehere.\r\n\r\n\r\n\r\n\r\n\r\n\r\nFrom the figure, it can be seen that on average building in Central and South America are more vulnerable than buildings in Asia. For the same inundation levels (x-axis), a higher damage ratio is expected (y-axis).\r\nIn order to keep things simple, this example will only keep the European damage curve and apply it to all presidential palaces, irrespectively of their location. This choice is completely arbitrary. I chose to keep the European curve because it is the one which associates the lowest expected damages to floods. This selection is based on the criterion that presidential palaces are likely to be built with high specifications and usually undergo constant checks and maintenance. In any case, the purpose of this example is to illustrate to general process rather giving exact damage figures.\r\n\r\n\r\n#load list of palaces\r\ndamage_curve <- read.csv(\"flood_damage_curve_residential_buildings.csv\")\r\n\r\n#Keep only the European curve and rename it\r\ndamage_curve <- damage_curve[,c(\"FloodDepth\",\"Europe\")]\r\ncolnames(damage_curve)[2] <- \"DamageRatio\"\r\n\r\n\r\n\r\nCalculating expected damages\r\nThe original damage curves in the JRC paper are defined by 9 flood depth points (0, 0.5, 1, …, 6). In order to get estimates for intermediate values (e.g. 0.3m of flooding) we can interpolate the damage ratios between these points. With the following code, I build a table that summarises the damage curve with a bit more granularity.\r\n\r\n\r\ninterpolated_damage_curve <- data.frame(FloodDepth=seq(0,6,0.1))\r\ninterpolated_damage_curve <- left_join(interpolated_damage_curve, damage_curve, by=\"FloodDepth\")\r\n\r\nlibrary(zoo)\r\ninterpolated_damage_curve <- interpolated_damage_curve %>%\r\n  zoo(.)%>%\r\n  apply(., MARGIN = 2, FUN = zoo::na.approx) %>%\r\n  as.data.frame()\r\n\r\n\r\n\r\nNow that we have a nice summary table, we can easily import the expected damage ratio for each presidential palaces by matching the expected flooding level under different return periods with the ones in the interpolated damage curve table.\r\n\r\n\r\n#In the data frame long table, each entry correspond to an asset-return period combination\r\n\r\n#merging is done on the rounded expected flood depth (converted to character to facilitate merging and avoid problems associated with floating point numbers)\r\nlong_table$rounded_flood_depth <- as.character(round(long_table$flood_depth,1))\r\ninterpolated_damage_curve$FloodDepth <- as.character(interpolated_damage_curve$FloodDepth)\r\nlong_table <- dplyr::left_join(long_table,interpolated_damage_curve,by=c(\"rounded_flood_depth\"=\"FloodDepth\"))\r\n\r\n\r\n\r\nThen, we can proceed to calculating the expected damage ratio for the presidential palaces by taking a weighted average of the damage ratios over each return period.\r\n\\[ \r\nE[\\text{Damage}]_i = \\sum^{n}_{j=1}\\frac{1}{RP_{j}}\\cdot Depth_{ij}\\cdot DR_{ij}\r\n\\]\r\nThis formula is nearly identical to the one used for the average flood level, the only addition is the term \\(DR_{ij}\\), which indicates the damage ratio incurred by the palace \\(i\\) in case of a flood with depth \\(Depth_{ij}\\). We can easily calculate this in R as follows:\r\n\r\n\r\n#calculating the expected flood level\r\ndamage_table <- long_table %>%\r\n  mutate(probability = 1/return_period,\r\n         expected_flood_damage = probability * flood_depth * DamageRatio) %>%\r\n  group_by(Building) %>%\r\n  summarise(expected_flood_damage = sum(expected_flood_damage), .groups=\"drop\")\r\n\r\n\r\n\r\nThe table below lists the palaces that have the highest expected flood damage. As we already mentioned before, the results for the first three palaces seems suspiciously high — if the 28.3% expected annual damage from flood were an accurate figure, fisheries would be a more fitting allocation of the grounds of Gabon’s Presidential palaces. It would be advisable to use alternative maps (possibly with higher granularity) to double-check these numbers. Also, there might be preventive measures in place that the maps do not take into account (e.g. embankments) that can explain this resul.\r\n\r\n\r\ndamage_table %>% \r\n  arrange(desc(expected_flood_damage))%>%\r\n  head(10) %>%\r\n  mutate(expected_flood_damage=100*expected_flood_damage)%>%\r\n  knitr::kable(., \r\n               caption=\"The ten palaces with the highest expected flooding damages\",\r\n               align=c(\"l\",\"c\"),\r\n               col.names=c(\"Palace\", \"Annualised expected damage (%)\"),\r\n               digits=1)\r\n\r\n\r\nTable 3: The ten palaces with the highest expected flooding damages\r\nPalace\r\nAnnualised expected damage (%)\r\nPresidential Palace, Libreville\r\n28.8\r\nVilla Hammerschmidt, Bonn\r\n16.6\r\nPresidential Palace, Khartoum\r\n6.2\r\nCarthage Palace, Tunis\r\n2.0\r\nMalacañang Palace, Manila\r\n0.7\r\nVilla Somalia, Mogadishu\r\n0.6\r\nAk Orda Presidential Palace, Nur-Sultan\r\n0.4\r\nBellevue Palace, Berlin\r\n0.2\r\nNicolau Lobato Presidential Palace, Dili\r\n0.1\r\nPresidential Palace, Djibouti City\r\n0.1\r\n\r\nClimate change: the elephant in the room\r\nThe entire analysis we conducted to this point ignores once crucial element: climate change. Because of it, extreme weather patterns are predicted to become more frequent and intense in most places around the globe. Hence, risk analyses should take this into account.\r\nMost hazard maps are based on historical data — they are backward looking by construction. The problem is that past occurrences might not be representative of future risk if the underlying climate is changing. The solution is using maps that incorporate the changes in risk due to climate change patterns. Climate models are used to predict how extreme weather events will change in the future under different emission scenarios.\r\nThe problem of these climate models is that they have inherent uncertainty in predicting complex system over long horizon. Therefore, estimates may come with large uncertainty bands and vary between models. Moreover, Many of these models have low spatial granularity, therefore results may be too coarse to be translated into risk maps. Nevertheless, there is much research going on in this area and our understanding and tools will certainly get better in the near future.\r\nI would like to mention that the Acqueduct flood maps are available also under two different climate scenarios (RCP4.5 and RCP8.5) with prediction from four different climate models. Dear reader, a perfect exercise to test your understanding would be to replicate this analysis with one of the hazard maps under the RCP8.5 scenario (corresponding to a pessimistic, business as usual concentration pathway) and compare the results to the ones obtained here with historic data. How do results change for our list of presidential palaces? You should find an increase in flood risk and expected flood damages.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-22-a-brief-introduction-to-natural-hazard-risk-analysis/flood.jpg",
    "last_modified": "2022-07-09T12:54:37+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-27-first-version-of-countries/",
    "title": "First version of countries",
    "description": "The first development version of the package countries is now available on Github. This post looks at how the package can be used to work with country names.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2022-02-27",
    "categories": [
      "coding"
    ],
    "contents": "\r\n\r\nContents\r\nInstalling and loading the package\r\nDealing with country names\r\nFurther options and warning messages\r\nUsing custom conversion tables\r\nWork in progress\r\n\r\n\r\n\r\n\r\n\r\ncountries is an R package designed to quickly wrangle, merge and explore country data. This package will contain functions to easily identify and convert country names, pull country info and datasets, merge country data from different sources, and make quick world maps.\r\nI recently released the first development version of the package, which is now available on my Github page. The package also has a website containing information on the package’s usage.\r\nIn this article, we will have a look at how countries can be used to work with country name. In particular, we will look in detail at the function country_name(), which can be used to convert country names to different naming conventions or to translate them to different languages. country_name() can identify countries even when they are provided in mixed formats or in different languages. It is robust to small misspellings and recognises many alternative country names and disused official names.\r\n\r\nInstalling and loading the package\r\nSince the package is not yet on CRAN, the development version needs to be downloaded directly from the Github repository. This can be done with the devtools package.\r\n\r\n\r\n# Install and load devtools\r\ninstall.packages(\"devtools\")\r\nlibrary(devtools)\r\n\r\n# Install countries\r\ndevtools::install_github(\"fbellelli/countries\", build_vignettes = TRUE)\r\n\r\n\r\n\r\nThe package can then be loaded normally\r\n\r\n\r\nlibrary(countries)\r\n\r\n\r\n\r\nDealing with country names\r\nThe function country_name() can be used to convert country names to different naming conventions or to translate them to different languages.\r\n\r\n\r\nexample <- c(\"United States\",\"DR Congo\", \"Morocco\")\r\n\r\n# Getting 3-letters ISO code\r\ncountry_name(x= example, to=\"ISO3\")\r\n\r\n\r\n[1] \"USA\" \"COD\" \"MAR\"\r\n\r\n# Translating to spanish\r\ncountry_name(x= example, to=\"name_es\")\r\n\r\n\r\n[1] \"Estados Unidos\"                 \r\n[2] \"República Democrática del Congo\"\r\n[3] \"Marruecos\"                      \r\n\r\nIf multiple arguments are passed to the argument to, the function will output a data.frame object, with one column corresponding to every naming convention.\r\n\r\n\r\n# Requesting translation to French and 2-letter and 3-letter ISO codes\r\ncountry_name(x= example, to=c(\"name_fr\",\"ISO2\",\"ISO3\"))\r\n\r\n\r\n                           name_fr ISO2 ISO3\r\n1                       États-Unis   US  USA\r\n2 République démocratique du Congo   CD  COD\r\n3                            Maroc   MA  MAR\r\n\r\nThe to argument supports all the following naming conventions:\r\n\r\nCODE\r\nDESCRIPTION\r\nsimple\r\nThis is a simple english version of the name containing only ASCII characters. This nomenclature is available for all countries.\r\nISO3\r\n3-letter country codes as defined in ISO standard 3166-1 alpha-3. This nomenclature is available only for the territories in the standard (currently 249 territories).\r\nISO2\r\n2-letter country codes as defined in ISO standard 3166-1 alpha-2. This nomenclature is available only for the territories in the standard (currently 249 territories).\r\nISO_code\r\nNumeric country codes as defined in ISO standard 3166-1 numeric. This country code is the same as the UN’s country number (M49 standard). This nomenclature is available for the territories in the ISO standard (currently 249 countries).\r\nUN_xx\r\nOfficial UN name in 6 official UN languages. Arabic (UN_ar), Chinese (UN_zh), English (UN_en), French (UN_fr), Spanish (UN_es), Russian (UN_ru). This nomenclature is only available for countries in the M49 standard (currently 249 territories).\r\nWTO_xx\r\nOfficial WTO name in 3 official WTO languages: English (WTO_en), French (WTO_fr), Spanish (WTO_es). This nomenclature is only available for WTO members and observers (currently 189 entities).\r\nname_xx\r\nTranslation of ISO country names in 28 different languages: Arabic (name_ar), Bulgarian (name_bg), Czech (name_cs), Danish (name_da), German (name_de), Greek (name_el), English (name_en), Spanish (name_es), Estonian (name_et), Basque (name_eu), Finnish (name_fi), French (name_fr), Hungarian (name_hu), Italian (name_it), Japponease (name_ja), Korean (name_ko), Lithuanian (name_lt), Dutch (name_nl), Norwegian (name_no), Polish (name_po), Portuguese (name_pt), Romenian (name_ro), Russian (name_ru), Slovak (name_sk), Swedish (name_sv), Thai (name_th), Ukranian (name_uk), Chinese simplified (name_zh), Chinese traditional (name_zh-tw)\r\nGTAP\r\nGTAP country and region codes.\r\nall\r\nConverts to all the nomenclatures and languages in this table\r\n\r\nFurther options and warning messages\r\ncountry_name() can identify countries even when they are provided in mixed formats or in different languages. It is robust to small misspellings and recognises many alternative country names and old nomenclatures.\r\n\r\n\r\nfuzzy_example <- c(\"US\",\"C@ète d^Ivoire\",\"Zaire\",\"FYROM\",\"Estados Unidos\",\"ITA\")\r\n\r\ncountry_name(x= fuzzy_example, to=c(\"UN_en\"))\r\n\r\n\r\nMultiple country IDs have been matched to the same country name\r\nSet - verbose - to TRUE for more details\r\n[1] \"United States of America\"        \r\n[2] \"Côte d’Ivoire\"                   \r\n[3] \"Democratic Republic of the Congo\"\r\n[4] \"North Macedonia\"                 \r\n[5] \"United States of America\"        \r\n[6] \"Italy\"                           \r\n\r\nMore information on the country matching process can be obtained by setting verbose=TRUE. The function will print information on:\r\nThe number of unique values provided by the user. In the example below 6 distinct strings have been provided.\r\nHow many country names correspond exactly to the ones in the function’s reference list and how many have been recognised with fuzzy matching. In the example below, \"C@ète d^Ivoire\" is the only name recognised with fuzzy matching. The function’s reference table can be accessed with the command data(country_reference_list).\r\nThe function prints summary statistics on fuzzy matching. The DISTANCE metric refers to the number of insertions, deletions or substitutions necessary to go from the provided string (\"C@ète d^Ivoire\") to the closest reference (\"Côte d'Ivoire\"). Lower DISTANCE statistics indicate more reliable fuzzy matching.\r\n\r\n\r\ncountry_name(x= fuzzy_example, to=c(\"UN_en\"), verbose=TRUE)\r\n\r\n\r\n\r\nIn total 6 unique country identifiers have been found\r\n5/6 have been matched with EXACT matching\r\n1/6 have been matched with FUZZY matching\r\n\r\nFuzzy matching DISTANCE summary:\r\n | Average:  3\r\n | Min: 3 \r\n | Q1: 3 \r\n | Median: 3 \r\n | Q3: 3 \r\n | Max: 3\r\n\r\nMultiple arguments have been matched to the same country name:\r\n  - Estados Unidos : United States of America \r\n  - US : United States of America\r\n[1] \"United States of America\"        \r\n[2] \"Côte d’Ivoire\"                   \r\n[3] \"Democratic Republic of the Congo\"\r\n[4] \"North Macedonia\"                 \r\n[5] \"United States of America\"        \r\n[6] \"Italy\"                           \r\n\r\nIn addition, setting verbose=TRUE will also print additional informations relating to specific warnings that are normally given by the function:\r\nMultiple country IDs have been matched to the same country name: This warning is issued if multiple strings have been matched to the same country. In verbose mode, the strings and corresponding countries will be listed. In the example above, both \"US\" and \"Estados Unidos\" are matched to the same country. If the vector of country names is a unique identifier, this could indicate that some country name was not recognised correctly. The user might consider using custom tables (refer to the next section).\r\nSome country IDs have no match in one or more country naming conventions: indicates that it is impossible to find an exact match for one or more country names with fuzzy_match=TRUE. The user might consider using fuzzy_match=TRUE or custom tables (refer to the next section).\r\nThere is low confidence on the matching of some country names: This warning indicates that some strings have been matched poorly. Thus indicating that the country might have been mididentified. In verbose mode the function will provide a list of problematic strings (see the example below). The user might consider using custom tables to solve this type of issues (refer to the next section).\r\nSome country IDs have no match in one or more country naming conventions: Conversion is requested to a nomenclature for which there is no information on the country. For instance, in the example below “Taiwan” has no correspondence in the UN M49 standard. In verbose mode, the function will print all the country names affected by this problem. The user might consider using custom tables to solve this type of issues (refer to the next section).\r\n\r\n\r\ncountry_name(x= c(\"Taiwan\",\"lsajdèd\"), to=c(\"UN_en\"), verbose=FALSE)\r\n\r\n\r\nSome country IDs have no match in one or more country naming conventions\r\nThere is low confidence on the matching of some country names\r\nSet - verbose - to TRUE for more details\r\n[1] NA                                \r\n[2] \"Lao People's Democratic Republic\"\r\n\r\nAll the information from verbose mode can be accessed by setting ´simplify=FALSE´. This will return a list object containing:\r\n´converted_data´: the normal output of the function\r\n´match_table´: the conversion table with information on the closest match for each country name and distance metrics.\r\n´summary´: summary values for the distance metrics\r\n´warning´: logical value indicating whether a warning is issued by the function\r\n´call´: the arguments passed by the user\r\nUsing custom conversion tables\r\nIn some cases, the user might be unhappy with the naming conversion or no valid conversion might exist for the provided territory. In these cases, it might be useful to tweak the conversion table. The package contains a utility function called ´match_table()´, which can be used to generate conversion tables for small adjustments.\r\n\r\n\r\nexample_custom <- c(\"Siam\",\"Burma\",\"H#@°)Koe2\")\r\n\r\n#suppose we are unhappy with how \"H#@°)Koe2\" is interpreted by the function\r\ncountry_name(x = example_custom, to = \"name_en\")\r\n\r\n\r\nThere is low confidence on the matching of some country names\r\nSet - verbose - to TRUE for more details\r\n[1] \"Thailand\"           \"Myanmar\"            \"Korea, Republic of\"\r\n\r\n#match_table can be used to generate a table for small adjustments\r\ntab <- match_table(x = example_custom, to = \"name_en\")\r\n\r\n\r\nThere is low confidence on the matching of some country names\r\n\r\ntab$name_en[2] <- \"Hong Kong\"\r\n\r\n#which can then be used for conversion\r\ncountry_name(x = example_custom, to = \"name_en\", custom_table = tab)\r\n\r\n\r\n[1] \"Thailand\"  \"Myanmar\"   \"Hong Kong\"\r\n\r\nWork in progress\r\nI am still working on the package. In the near future, the following items will be added to the package:\r\nfunction to test strings on whether they are country names\r\nfunctions to identify columns in dataframes containing country names and date information\r\nfunction for downloading up-to-date information on countries (e.g. currency, language, population, etc.)\r\nfunction for downloading country data for analysis from different sources (e.g. UN, World Bank, FRED, etc.)\r\nfunction to quickly merge country data from different sources\r\nfunction to tag countries based on common criteria (e.g. developing status, World bank income group, geographic region, etc.)\r\nfunction to easily plot chloropleth maps\r\npublish on CRAN\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-02-27-first-version-of-countries/../../images/Countries_logo.png",
    "last_modified": "2022-03-26T00:15:39+01:00",
    "input_file": {},
    "preview_width": 864,
    "preview_height": 1000
  },
  {
    "path": "posts/2021-12-18-mishmash-of-charts/",
    "title": "Mishmash of charts",
    "description": "This article is a selection of charts that I prepared over the last three years.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-12-18",
    "categories": [
      "economics",
      "other"
    ],
    "contents": "\r\n\r\nContents\r\nTrade war\r\nCOVID-19 decoupling\r\nFishing\r\nFinancial shocks\r\nEconomic activity and carbon emissions\r\nConflicts in history\r\nClimate risks\r\nInternational environmental agreements\r\nEnvironmental policy\r\nUncertainty\r\nEnergy\r\n\r\nTrade war\r\nIn 2019 there was a rapid escalation of trade tensions after Trump imposed tariffs aiming to punish China for its widening trade surplus vis-à-vis the Unites States. I made the following maps for the bank Pictet to illustrate the rapid progression of Chinese exports since its accession to WTO. China progressively becomes a bigger exporter than the United States in almost every market in the world.\r\nLiz Faunce (Financial Times) compilled these maps into a gif and inserted them on an article on this topic. To my surprise, a few months later it got selected among the FT ten charts that tell the story of 2019.\r\n\r\n\r\n\r\nCOVID-19 decoupling\r\nThis charts shows the decoupling of COVID cases and deaths in the UK following the vaccination campaign of 2021. Until then, the death curve followed cases with an approximate lag of two weeks. Each spike in cases corresponded to a spike in deaths (very clear for the January 2021 spike). The mortality rate from COVID plummeted after vaccination roll-out. The July 2021 spike in COVID cases is not followed by a similar surge in the death curves.\r\n\r\n\r\n\r\n{\"x\":{\"attrs\":{\"axes\":{\"x\":{\"pixelsPerLabel\":60,\"drawAxis\":true},\"y\":{\"drawAxis\":true},\"y2\":[]},\"series\":{\"New cases\":{\"axis\":\"y\",\"strokeWidth\":2},\"Deaths\":{\"axis\":\"y2\",\"strokeWidth\":3}},\"colors\":[\"navy\",\"firebrick\"],\"labels\":[\"day\",\"New cases\",\"Deaths\"],\"legend\":\"auto\",\"retainDateWindow\":false,\"stackedGraph\":false,\"fillGraph\":true,\"fillAlpha\":0.3,\"stepPlot\":true,\"drawPoints\":false,\"pointSize\":1,\"drawGapEdgePoints\":false,\"connectSeparatedPoints\":false,\"strokeWidth\":1,\"strokeBorderColor\":\"white\",\"colorValue\":0.5,\"colorSaturation\":1,\"includeZero\":false,\"drawAxesAtZero\":false,\"logscale\":false,\"axisTickSize\":3,\"axisLineColor\":\"black\",\"axisLineWidth\":0.3,\"axisLabelColor\":\"black\",\"axisLabelFontSize\":14,\"axisLabelWidth\":60,\"drawGrid\":true,\"gridLineWidth\":0.3,\"rightGap\":5,\"digitsAfterDecimal\":2,\"labelsKMB\":false,\"labelsKMG2\":false,\"labelsUTC\":false,\"maxNumberWidth\":6,\"animatedZooms\":false,\"mobileDisableYTouch\":true,\"disableZoom\":false,\"showRangeSelector\":true,\"dateWindow\":[\"2021-01-01T00:00:00.000Z\",\"2021-08-01T00:00:00.000Z\"],\"rangeSelectorHeight\":40,\"rangeSelectorPlotFillColor\":\" #A7B1C4\",\"rangeSelectorPlotStrokeColor\":\"#808FAB\",\"interactionModel\":\"Dygraph.Interaction.defaultModel\",\"ylabel\":\"New cases\",\"y2label\":\"Deaths\"},\"scale\":\"daily\",\"group\":\"covid\",\"annotations\":[],\"shadings\":[],\"events\":[],\"format\":\"date\",\"data\":[[\"2020-02-11T00:00:00.000Z\",\"2020-02-12T00:00:00.000Z\",\"2020-02-13T00:00:00.000Z\",\"2020-02-14T00:00:00.000Z\",\"2020-02-15T00:00:00.000Z\",\"2020-02-16T00:00:00.000Z\",\"2020-02-17T00:00:00.000Z\",\"2020-02-18T00:00:00.000Z\",\"2020-02-19T00:00:00.000Z\",\"2020-02-20T00:00:00.000Z\",\"2020-02-21T00:00:00.000Z\",\"2020-02-22T00:00:00.000Z\",\"2020-02-23T00:00:00.000Z\",\"2020-02-24T00:00:00.000Z\",\"2020-02-25T00:00:00.000Z\",\"2020-02-26T00:00:00.000Z\",\"2020-02-27T00:00:00.000Z\",\"2020-02-28T00:00:00.000Z\",\"2020-02-29T00:00:00.000Z\",\"2020-03-01T00:00:00.000Z\",\"2020-03-02T00:00:00.000Z\",\"2020-03-03T00:00:00.000Z\",\"2020-03-04T00:00:00.000Z\",\"2020-03-05T00:00:00.000Z\",\"2020-03-06T00:00:00.000Z\",\"2020-03-07T00:00:00.000Z\",\"2020-03-08T00:00:00.000Z\",\"2020-03-09T00:00:00.000Z\",\"2020-03-10T00:00:00.000Z\",\"2020-03-11T00:00:00.000Z\",\"2020-03-12T00:00:00.000Z\",\"2020-03-13T00:00:00.000Z\",\"2020-03-14T00:00:00.000Z\",\"2020-03-15T00:00:00.000Z\",\"2020-03-16T00:00:00.000Z\",\"2020-03-17T00:00:00.000Z\",\"2020-03-18T00:00:00.000Z\",\"2020-03-19T00:00:00.000Z\",\"2020-03-20T00:00:00.000Z\",\"2020-03-21T00:00:00.000Z\",\"2020-03-22T00:00:00.000Z\",\"2020-03-23T00:00:00.000Z\",\"2020-03-24T00:00:00.000Z\",\"2020-03-25T00:00:00.000Z\",\"2020-03-26T00:00:00.000Z\",\"2020-03-27T00:00:00.000Z\",\"2020-03-28T00:00:00.000Z\",\"2020-03-29T00:00:00.000Z\",\"2020-03-30T00:00:00.000Z\",\"2020-03-31T00:00:00.000Z\",\"2020-04-01T00:00:00.000Z\",\"2020-04-02T00:00:00.000Z\",\"2020-04-03T00:00:00.000Z\",\"2020-04-04T00:00:00.000Z\",\"2020-04-05T00:00:00.000Z\",\"2020-04-06T00:00:00.000Z\",\"2020-04-07T00:00:00.000Z\",\"2020-04-08T00:00:00.000Z\",\"2020-04-09T00:00:00.000Z\",\"2020-04-10T00:00:00.000Z\",\"2020-04-11T00:00:00.000Z\",\"2020-04-12T00:00:00.000Z\",\"2020-04-13T00:00:00.000Z\",\"2020-04-14T00:00:00.000Z\",\"2020-04-15T00:00:00.000Z\",\"2020-04-16T00:00:00.000Z\",\"2020-04-17T00:00:00.000Z\",\"2020-04-18T00:00:00.000Z\",\"2020-04-19T00:00:00.000Z\",\"2020-04-20T00:00:00.000Z\",\"2020-04-21T00:00:00.000Z\",\"2020-04-22T00:00:00.000Z\",\"2020-04-23T00:00:00.000Z\",\"2020-04-24T00:00:00.000Z\",\"2020-04-25T00:00:00.000Z\",\"2020-04-26T00:00:00.000Z\",\"2020-04-27T00:00:00.000Z\",\"2020-04-28T00:00:00.000Z\",\"2020-04-29T00:00:00.000Z\",\"2020-04-30T00:00:00.000Z\",\"2020-05-01T00:00:00.000Z\",\"2020-05-02T00:00:00.000Z\",\"2020-05-03T00:00:00.000Z\",\"2020-05-04T00:00:00.000Z\",\"2020-05-05T00:00:00.000Z\",\"2020-05-06T00:00:00.000Z\",\"2020-05-07T00:00:00.000Z\",\"2020-05-08T00:00:00.000Z\",\"2020-05-09T00:00:00.000Z\",\"2020-05-10T00:00:00.000Z\",\"2020-05-11T00:00:00.000Z\",\"2020-05-12T00:00:00.000Z\",\"2020-05-13T00:00:00.000Z\",\"2020-05-14T00:00:00.000Z\",\"2020-05-15T00:00:00.000Z\",\"2020-05-16T00:00:00.000Z\",\"2020-05-17T00:00:00.000Z\",\"2020-05-18T00:00:00.000Z\",\"2020-05-19T00:00:00.000Z\",\"2020-05-20T00:00:00.000Z\",\"2020-05-21T00:00:00.000Z\",\"2020-05-22T00:00:00.000Z\",\"2020-05-23T00:00:00.000Z\",\"2020-05-24T00:00:00.000Z\",\"2020-05-25T00:00:00.000Z\",\"2020-05-26T00:00:00.000Z\",\"2020-05-27T00:00:00.000Z\",\"2020-05-28T00:00:00.000Z\",\"2020-05-29T00:00:00.000Z\",\"2020-05-30T00:00:00.000Z\",\"2020-05-31T00:00:00.000Z\",\"2020-06-01T00:00:00.000Z\",\"2020-06-02T00:00:00.000Z\",\"2020-06-03T00:00:00.000Z\",\"2020-06-04T00:00:00.000Z\",\"2020-06-05T00:00:00.000Z\",\"2020-06-06T00:00:00.000Z\",\"2020-06-07T00:00:00.000Z\",\"2020-06-08T00:00:00.000Z\",\"2020-06-09T00:00:00.000Z\",\"2020-06-10T00:00:00.000Z\",\"2020-06-11T00:00:00.000Z\",\"2020-06-12T00:00:00.000Z\",\"2020-06-13T00:00:00.000Z\",\"2020-06-14T00:00:00.000Z\",\"2020-06-15T00:00:00.000Z\",\"2020-06-16T00:00:00.000Z\",\"2020-06-17T00:00:00.000Z\",\"2020-06-18T00:00:00.000Z\",\"2020-06-19T00:00:00.000Z\",\"2020-06-20T00:00:00.000Z\",\"2020-06-21T00:00:00.000Z\",\"2020-06-22T00:00:00.000Z\",\"2020-06-23T00:00:00.000Z\",\"2020-06-24T00:00:00.000Z\",\"2020-06-25T00:00:00.000Z\",\"2020-06-26T00:00:00.000Z\",\"2020-06-27T00:00:00.000Z\",\"2020-06-28T00:00:00.000Z\",\"2020-06-29T00:00:00.000Z\",\"2020-06-30T00:00:00.000Z\",\"2020-07-01T00:00:00.000Z\",\"2020-07-02T00:00:00.000Z\",\"2020-07-03T00:00:00.000Z\",\"2020-07-04T00:00:00.000Z\",\"2020-07-05T00:00:00.000Z\",\"2020-07-06T00:00:00.000Z\",\"2020-07-07T00:00:00.000Z\",\"2020-07-08T00:00:00.000Z\",\"2020-07-09T00:00:00.000Z\",\"2020-07-10T00:00:00.000Z\",\"2020-07-11T00:00:00.000Z\",\"2020-07-12T00:00:00.000Z\",\"2020-07-13T00:00:00.000Z\",\"2020-07-14T00:00:00.000Z\",\"2020-07-15T00:00:00.000Z\",\"2020-07-16T00:00:00.000Z\",\"2020-07-17T00:00:00.000Z\",\"2020-07-18T00:00:00.000Z\",\"2020-07-19T00:00:00.000Z\",\"2020-07-20T00:00:00.000Z\",\"2020-07-21T00:00:00.000Z\",\"2020-07-22T00:00:00.000Z\",\"2020-07-23T00:00:00.000Z\",\"2020-07-24T00:00:00.000Z\",\"2020-07-25T00:00:00.000Z\",\"2020-07-26T00:00:00.000Z\",\"2020-07-27T00:00:00.000Z\",\"2020-07-28T00:00:00.000Z\",\"2020-07-29T00:00:00.000Z\",\"2020-07-30T00:00:00.000Z\",\"2020-07-31T00:00:00.000Z\",\"2020-08-01T00:00:00.000Z\",\"2020-08-02T00:00:00.000Z\",\"2020-08-03T00:00:00.000Z\",\"2020-08-04T00:00:00.000Z\",\"2020-08-05T00:00:00.000Z\",\"2020-08-06T00:00:00.000Z\",\"2020-08-07T00:00:00.000Z\",\"2020-08-08T00:00:00.000Z\",\"2020-08-09T00:00:00.000Z\",\"2020-08-10T00:00:00.000Z\",\"2020-08-11T00:00:00.000Z\",\"2020-08-12T00:00:00.000Z\",\"2020-08-13T00:00:00.000Z\",\"2020-08-14T00:00:00.000Z\",\"2020-08-15T00:00:00.000Z\",\"2020-08-16T00:00:00.000Z\",\"2020-08-17T00:00:00.000Z\",\"2020-08-18T00:00:00.000Z\",\"2020-08-19T00:00:00.000Z\",\"2020-08-20T00:00:00.000Z\",\"2020-08-21T00:00:00.000Z\",\"2020-08-22T00:00:00.000Z\",\"2020-08-23T00:00:00.000Z\",\"2020-08-24T00:00:00.000Z\",\"2020-08-25T00:00:00.000Z\",\"2020-08-26T00:00:00.000Z\",\"2020-08-27T00:00:00.000Z\",\"2020-08-28T00:00:00.000Z\",\"2020-08-29T00:00:00.000Z\",\"2020-08-30T00:00:00.000Z\",\"2020-08-31T00:00:00.000Z\",\"2020-09-01T00:00:00.000Z\",\"2020-09-02T00:00:00.000Z\",\"2020-09-03T00:00:00.000Z\",\"2020-09-04T00:00:00.000Z\",\"2020-09-05T00:00:00.000Z\",\"2020-09-06T00:00:00.000Z\",\"2020-09-07T00:00:00.000Z\",\"2020-09-08T00:00:00.000Z\",\"2020-09-09T00:00:00.000Z\",\"2020-09-10T00:00:00.000Z\",\"2020-09-11T00:00:00.000Z\",\"2020-09-12T00:00:00.000Z\",\"2020-09-13T00:00:00.000Z\",\"2020-09-14T00:00:00.000Z\",\"2020-09-15T00:00:00.000Z\",\"2020-09-16T00:00:00.000Z\",\"2020-09-17T00:00:00.000Z\",\"2020-09-18T00:00:00.000Z\",\"2020-09-19T00:00:00.000Z\",\"2020-09-20T00:00:00.000Z\",\"2020-09-21T00:00:00.000Z\",\"2020-09-22T00:00:00.000Z\",\"2020-09-23T00:00:00.000Z\",\"2020-09-24T00:00:00.000Z\",\"2020-09-25T00:00:00.000Z\",\"2020-09-26T00:00:00.000Z\",\"2020-09-27T00:00:00.000Z\",\"2020-09-28T00:00:00.000Z\",\"2020-09-29T00:00:00.000Z\",\"2020-09-30T00:00:00.000Z\",\"2020-10-01T00:00:00.000Z\",\"2020-10-02T00:00:00.000Z\",\"2020-10-03T00:00:00.000Z\",\"2020-10-04T00:00:00.000Z\",\"2020-10-05T00:00:00.000Z\",\"2020-10-06T00:00:00.000Z\",\"2020-10-07T00:00:00.000Z\",\"2020-10-08T00:00:00.000Z\",\"2020-10-09T00:00:00.000Z\",\"2020-10-10T00:00:00.000Z\",\"2020-10-11T00:00:00.000Z\",\"2020-10-12T00:00:00.000Z\",\"2020-10-13T00:00:00.000Z\",\"2020-10-14T00:00:00.000Z\",\"2020-10-15T00:00:00.000Z\",\"2020-10-16T00:00:00.000Z\",\"2020-10-17T00:00:00.000Z\",\"2020-10-18T00:00:00.000Z\",\"2020-10-19T00:00:00.000Z\",\"2020-10-20T00:00:00.000Z\",\"2020-10-21T00:00:00.000Z\",\"2020-10-22T00:00:00.000Z\",\"2020-10-23T00:00:00.000Z\",\"2020-10-24T00:00:00.000Z\",\"2020-10-25T00:00:00.000Z\",\"2020-10-26T00:00:00.000Z\",\"2020-10-27T00:00:00.000Z\",\"2020-10-28T00:00:00.000Z\",\"2020-10-29T00:00:00.000Z\",\"2020-10-30T00:00:00.000Z\",\"2020-10-31T00:00:00.000Z\",\"2020-11-01T00:00:00.000Z\",\"2020-11-02T00:00:00.000Z\",\"2020-11-03T00:00:00.000Z\",\"2020-11-04T00:00:00.000Z\",\"2020-11-05T00:00:00.000Z\",\"2020-11-06T00:00:00.000Z\",\"2020-11-07T00:00:00.000Z\",\"2020-11-08T00:00:00.000Z\",\"2020-11-09T00:00:00.000Z\",\"2020-11-10T00:00:00.000Z\",\"2020-11-11T00:00:00.000Z\",\"2020-11-12T00:00:00.000Z\",\"2020-11-13T00:00:00.000Z\",\"2020-11-14T00:00:00.000Z\",\"2020-11-15T00:00:00.000Z\",\"2020-11-16T00:00:00.000Z\",\"2020-11-17T00:00:00.000Z\",\"2020-11-18T00:00:00.000Z\",\"2020-11-19T00:00:00.000Z\",\"2020-11-20T00:00:00.000Z\",\"2020-11-21T00:00:00.000Z\",\"2020-11-22T00:00:00.000Z\",\"2020-11-23T00:00:00.000Z\",\"2020-11-24T00:00:00.000Z\",\"2020-11-25T00:00:00.000Z\",\"2020-11-26T00:00:00.000Z\",\"2020-11-27T00:00:00.000Z\",\"2020-11-28T00:00:00.000Z\",\"2020-11-29T00:00:00.000Z\",\"2020-11-30T00:00:00.000Z\",\"2020-12-01T00:00:00.000Z\",\"2020-12-02T00:00:00.000Z\",\"2020-12-03T00:00:00.000Z\",\"2020-12-04T00:00:00.000Z\",\"2020-12-05T00:00:00.000Z\",\"2020-12-06T00:00:00.000Z\",\"2020-12-07T00:00:00.000Z\",\"2020-12-08T00:00:00.000Z\",\"2020-12-09T00:00:00.000Z\",\"2020-12-10T00:00:00.000Z\",\"2020-12-11T00:00:00.000Z\",\"2020-12-12T00:00:00.000Z\",\"2020-12-13T00:00:00.000Z\",\"2020-12-14T00:00:00.000Z\",\"2020-12-15T00:00:00.000Z\",\"2020-12-16T00:00:00.000Z\",\"2020-12-17T00:00:00.000Z\",\"2020-12-18T00:00:00.000Z\",\"2020-12-19T00:00:00.000Z\",\"2020-12-20T00:00:00.000Z\",\"2020-12-21T00:00:00.000Z\",\"2020-12-22T00:00:00.000Z\",\"2020-12-23T00:00:00.000Z\",\"2020-12-24T00:00:00.000Z\",\"2020-12-25T00:00:00.000Z\",\"2020-12-26T00:00:00.000Z\",\"2020-12-27T00:00:00.000Z\",\"2020-12-28T00:00:00.000Z\",\"2020-12-29T00:00:00.000Z\",\"2020-12-30T00:00:00.000Z\",\"2020-12-31T00:00:00.000Z\",\"2021-01-01T00:00:00.000Z\",\"2021-01-02T00:00:00.000Z\",\"2021-01-03T00:00:00.000Z\",\"2021-01-04T00:00:00.000Z\",\"2021-01-05T00:00:00.000Z\",\"2021-01-06T00:00:00.000Z\",\"2021-01-07T00:00:00.000Z\",\"2021-01-08T00:00:00.000Z\",\"2021-01-09T00:00:00.000Z\",\"2021-01-10T00:00:00.000Z\",\"2021-01-11T00:00:00.000Z\",\"2021-01-12T00:00:00.000Z\",\"2021-01-13T00:00:00.000Z\",\"2021-01-14T00:00:00.000Z\",\"2021-01-15T00:00:00.000Z\",\"2021-01-16T00:00:00.000Z\",\"2021-01-17T00:00:00.000Z\",\"2021-01-18T00:00:00.000Z\",\"2021-01-19T00:00:00.000Z\",\"2021-01-20T00:00:00.000Z\",\"2021-01-21T00:00:00.000Z\",\"2021-01-22T00:00:00.000Z\",\"2021-01-23T00:00:00.000Z\",\"2021-01-24T00:00:00.000Z\",\"2021-01-25T00:00:00.000Z\",\"2021-01-26T00:00:00.000Z\",\"2021-01-27T00:00:00.000Z\",\"2021-01-28T00:00:00.000Z\",\"2021-01-29T00:00:00.000Z\",\"2021-01-30T00:00:00.000Z\",\"2021-01-31T00:00:00.000Z\",\"2021-02-01T00:00:00.000Z\",\"2021-02-02T00:00:00.000Z\",\"2021-02-03T00:00:00.000Z\",\"2021-02-04T00:00:00.000Z\",\"2021-02-05T00:00:00.000Z\",\"2021-02-06T00:00:00.000Z\",\"2021-02-07T00:00:00.000Z\",\"2021-02-08T00:00:00.000Z\",\"2021-02-09T00:00:00.000Z\",\"2021-02-10T00:00:00.000Z\",\"2021-02-11T00:00:00.000Z\",\"2021-02-12T00:00:00.000Z\",\"2021-02-13T00:00:00.000Z\",\"2021-02-14T00:00:00.000Z\",\"2021-02-15T00:00:00.000Z\",\"2021-02-16T00:00:00.000Z\",\"2021-02-17T00:00:00.000Z\",\"2021-02-18T00:00:00.000Z\",\"2021-02-19T00:00:00.000Z\",\"2021-02-20T00:00:00.000Z\",\"2021-02-21T00:00:00.000Z\",\"2021-02-22T00:00:00.000Z\",\"2021-02-23T00:00:00.000Z\",\"2021-02-24T00:00:00.000Z\",\"2021-02-25T00:00:00.000Z\",\"2021-02-26T00:00:00.000Z\",\"2021-02-27T00:00:00.000Z\",\"2021-02-28T00:00:00.000Z\",\"2021-03-01T00:00:00.000Z\",\"2021-03-02T00:00:00.000Z\",\"2021-03-03T00:00:00.000Z\",\"2021-03-04T00:00:00.000Z\",\"2021-03-05T00:00:00.000Z\",\"2021-03-06T00:00:00.000Z\",\"2021-03-07T00:00:00.000Z\",\"2021-03-08T00:00:00.000Z\",\"2021-03-09T00:00:00.000Z\",\"2021-03-10T00:00:00.000Z\",\"2021-03-11T00:00:00.000Z\",\"2021-03-12T00:00:00.000Z\",\"2021-03-13T00:00:00.000Z\",\"2021-03-14T00:00:00.000Z\",\"2021-03-15T00:00:00.000Z\",\"2021-03-16T00:00:00.000Z\",\"2021-03-17T00:00:00.000Z\",\"2021-03-18T00:00:00.000Z\",\"2021-03-19T00:00:00.000Z\",\"2021-03-20T00:00:00.000Z\",\"2021-03-21T00:00:00.000Z\",\"2021-03-22T00:00:00.000Z\",\"2021-03-23T00:00:00.000Z\",\"2021-03-24T00:00:00.000Z\",\"2021-03-25T00:00:00.000Z\",\"2021-03-26T00:00:00.000Z\",\"2021-03-27T00:00:00.000Z\",\"2021-03-28T00:00:00.000Z\",\"2021-03-29T00:00:00.000Z\",\"2021-03-30T00:00:00.000Z\",\"2021-03-31T00:00:00.000Z\",\"2021-04-01T00:00:00.000Z\",\"2021-04-02T00:00:00.000Z\",\"2021-04-03T00:00:00.000Z\",\"2021-04-04T00:00:00.000Z\",\"2021-04-05T00:00:00.000Z\",\"2021-04-06T00:00:00.000Z\",\"2021-04-07T00:00:00.000Z\",\"2021-04-08T00:00:00.000Z\",\"2021-04-09T00:00:00.000Z\",\"2021-04-10T00:00:00.000Z\",\"2021-04-11T00:00:00.000Z\",\"2021-04-12T00:00:00.000Z\",\"2021-04-13T00:00:00.000Z\",\"2021-04-14T00:00:00.000Z\",\"2021-04-15T00:00:00.000Z\",\"2021-04-16T00:00:00.000Z\",\"2021-04-17T00:00:00.000Z\",\"2021-04-18T00:00:00.000Z\",\"2021-04-19T00:00:00.000Z\",\"2021-04-20T00:00:00.000Z\",\"2021-04-21T00:00:00.000Z\",\"2021-04-22T00:00:00.000Z\",\"2021-04-23T00:00:00.000Z\",\"2021-04-24T00:00:00.000Z\",\"2021-04-25T00:00:00.000Z\",\"2021-04-26T00:00:00.000Z\",\"2021-04-27T00:00:00.000Z\",\"2021-04-28T00:00:00.000Z\",\"2021-04-29T00:00:00.000Z\",\"2021-04-30T00:00:00.000Z\",\"2021-05-01T00:00:00.000Z\",\"2021-05-02T00:00:00.000Z\",\"2021-05-03T00:00:00.000Z\",\"2021-05-04T00:00:00.000Z\",\"2021-05-05T00:00:00.000Z\",\"2021-05-06T00:00:00.000Z\",\"2021-05-07T00:00:00.000Z\",\"2021-05-08T00:00:00.000Z\",\"2021-05-09T00:00:00.000Z\",\"2021-05-10T00:00:00.000Z\",\"2021-05-11T00:00:00.000Z\",\"2021-05-12T00:00:00.000Z\",\"2021-05-13T00:00:00.000Z\",\"2021-05-14T00:00:00.000Z\",\"2021-05-15T00:00:00.000Z\",\"2021-05-16T00:00:00.000Z\",\"2021-05-17T00:00:00.000Z\",\"2021-05-18T00:00:00.000Z\",\"2021-05-19T00:00:00.000Z\",\"2021-05-20T00:00:00.000Z\",\"2021-05-21T00:00:00.000Z\",\"2021-05-22T00:00:00.000Z\",\"2021-05-23T00:00:00.000Z\",\"2021-05-24T00:00:00.000Z\",\"2021-05-25T00:00:00.000Z\",\"2021-05-26T00:00:00.000Z\",\"2021-05-27T00:00:00.000Z\",\"2021-05-28T00:00:00.000Z\",\"2021-05-29T00:00:00.000Z\",\"2021-05-30T00:00:00.000Z\",\"2021-05-31T00:00:00.000Z\",\"2021-06-01T00:00:00.000Z\",\"2021-06-02T00:00:00.000Z\",\"2021-06-03T00:00:00.000Z\",\"2021-06-04T00:00:00.000Z\",\"2021-06-05T00:00:00.000Z\",\"2021-06-06T00:00:00.000Z\",\"2021-06-07T00:00:00.000Z\",\"2021-06-08T00:00:00.000Z\",\"2021-06-09T00:00:00.000Z\",\"2021-06-10T00:00:00.000Z\",\"2021-06-11T00:00:00.000Z\",\"2021-06-12T00:00:00.000Z\",\"2021-06-13T00:00:00.000Z\",\"2021-06-14T00:00:00.000Z\",\"2021-06-15T00:00:00.000Z\",\"2021-06-16T00:00:00.000Z\",\"2021-06-17T00:00:00.000Z\",\"2021-06-18T00:00:00.000Z\",\"2021-06-19T00:00:00.000Z\",\"2021-06-20T00:00:00.000Z\",\"2021-06-21T00:00:00.000Z\",\"2021-06-22T00:00:00.000Z\",\"2021-06-23T00:00:00.000Z\",\"2021-06-24T00:00:00.000Z\",\"2021-06-25T00:00:00.000Z\",\"2021-06-26T00:00:00.000Z\",\"2021-06-27T00:00:00.000Z\",\"2021-06-28T00:00:00.000Z\",\"2021-06-29T00:00:00.000Z\",\"2021-06-30T00:00:00.000Z\",\"2021-07-01T00:00:00.000Z\",\"2021-07-02T00:00:00.000Z\",\"2021-07-03T00:00:00.000Z\",\"2021-07-04T00:00:00.000Z\",\"2021-07-05T00:00:00.000Z\",\"2021-07-06T00:00:00.000Z\",\"2021-07-07T00:00:00.000Z\",\"2021-07-08T00:00:00.000Z\",\"2021-07-09T00:00:00.000Z\",\"2021-07-10T00:00:00.000Z\",\"2021-07-11T00:00:00.000Z\",\"2021-07-12T00:00:00.000Z\",\"2021-07-13T00:00:00.000Z\",\"2021-07-14T00:00:00.000Z\",\"2021-07-15T00:00:00.000Z\",\"2021-07-16T00:00:00.000Z\",\"2021-07-17T00:00:00.000Z\",\"2021-07-18T00:00:00.000Z\",\"2021-07-19T00:00:00.000Z\",\"2021-07-20T00:00:00.000Z\",\"2021-07-21T00:00:00.000Z\",\"2021-07-22T00:00:00.000Z\",\"2021-07-23T00:00:00.000Z\",\"2021-07-24T00:00:00.000Z\",\"2021-07-25T00:00:00.000Z\",\"2021-07-26T00:00:00.000Z\",\"2021-07-27T00:00:00.000Z\",\"2021-07-28T00:00:00.000Z\",\"2021-07-29T00:00:00.000Z\",\"2021-07-30T00:00:00.000Z\",\"2021-07-31T00:00:00.000Z\",\"2021-08-01T00:00:00.000Z\"],[null,null,null,null,null,null,0.142857142857143,0,0,0,0,0,0,0.142857142857143,0.571428571428571,0.857142857142857,1.14285714285714,1.57142857142857,1.71428571428571,2.28571428571429,3.85714285714286,4.28571428571429,6.57142857142857,8.28571428571429,11.2857142857143,13.2857142857143,15.8571428571429,21.7142857142857,34,57.5714285714286,79,94.7142857142857,114,134.428571428571,160.142857142857,191.428571428571,216,239.857142857143,281.714285714286,310.285714285714,349.285714285714,414.142857142857,460,517.857142857143,579.714285714286,635.285714285714,667.571428571429,690,715.714285714286,758.857142857143,790.142857142857,833.571428571429,857.285714285714,884.571428571429,890,888.428571428571,891.142857142857,876,837.857142857143,785.857142857143,750.428571428571,731.571428571429,694.571428571429,643.428571428571,613,580.714285714286,575.142857142857,558.142857142857,543,519.571428571429,501,463.571428571429,455.714285714286,427,417.428571428571,405.428571428571,403.285714285714,381.571428571429,385.857142857143,372.142857142857,368.714285714286,356.428571428571,336.142857142857,312,298.285714285714,275.285714285714,253.714285714286,232.571428571429,215.714285714286,209.571428571429,197.142857142857,193.714285714286,184.714285714286,168.285714285714,157.857142857143,149.714285714286,142.857142857143,135.857142857143,126.714285714286,117.857142857143,117.571428571429,110.142857142857,109.142857142857,105.428571428571,97.4285714285714,88.4285714285714,80.1428571428571,68.5714285714286,65,61.2857142857143,59.2857142857143,58.2857142857143,55.8571428571429,55.1428571428571,52.7142857142857,51.1428571428571,52.2857142857143,53.2857142857143,54.2857142857143,57.4285714285714,53.5714285714286,52,53.2857142857143,52.1428571428571,50.1428571428571,47.8571428571429,44.2857142857143,43,42.8571428571429,40.4285714285714,39,38.4285714285714,39.8571428571429,40.4285714285714,40.8571428571429,42.4285714285714,44,44.4285714285714,43.7142857142857,44.7142857142857,45,44.4285714285714,42,40.5714285714286,40.5714285714286,44.7142857142857,44.1428571428571,45.2857142857143,47.4285714285714,49.4285714285714,49.7142857142857,47.8571428571429,46,50.2857142857143,50.5714285714286,53.2857142857143,55.5714285714286,56.7142857142857,60.7142857142857,61.1428571428571,63.1428571428571,65.8571428571429,66.4285714285714,66.4285714285714,71.4285714285714,72.7142857142857,76.1428571428571,76.4285714285714,79.1428571428571,81.8571428571429,86.4285714285714,85,85.2857142857143,86.7142857142857,84.8571428571429,85.4285714285714,87.4285714285714,87.8571428571429,94.7142857142857,94.2857142857143,93.1428571428571,101.142857142857,107.571428571429,114.428571428571,117.142857142857,117.857142857143,125.285714285714,128.285714285714,134.857142857143,139.428571428571,138.285714285714,149.714285714286,155.428571428571,157.142857142857,165.285714285714,166.285714285714,164.714285714286,166.285714285714,169.857142857143,177.571428571429,180.428571428571,178.714285714286,181.571428571429,202.142857142857,226.428571428571,243.285714285714,262.714285714286,281.571428571429,291.714285714286,327,331,332.571428571429,339,335.714285714286,329.714285714286,316.571428571429,293,282.714285714286,275.285714285714,265.428571428571,273,288.714285714286,331.142857142857,349.571428571429,385.142857142857,437.285714285714,476.571428571429,507.571428571429,537.428571428571,554.714285714286,600.285714285714,626.571428571429,674,741.857142857143,804,838.857142857143,880.714285714286,958.714285714286,1026.14285714286,1086.57142857143,1144.85714285714,1188.85714285714,1201,1189.28571428571,1229.71428571429,1265.14285714286,1295.28571428571,1329.57142857143,1373.28571428571,1406.14285714286,1485.57142857143,1594.28571428571,1722.14285714286,1825.85714285714,1889.85714285714,1940.57142857143,1987.57142857143,1986.57142857143,2013.42857142857,1980.14285714286,1925.14285714286,1902,1882.42857142857,1875,1862.42857142857,1917.85714285714,1924,1935.57142857143,1947.28571428571,1982.28571428571,2020,2099,2122.42857142857,2207.42857142857,2330.71428571429,2437.42857142857,2519.42857142857,2558.28571428571,2563.57142857143,2562.57142857143,2538.57142857143,2473.57142857143,2379.71428571429,2296.28571428571,2233,2188.42857142857,2090.85714285714,2033.14285714286,2002.57142857143,1985.85714285714,1998.42857142857,2021.42857142857,2045.71428571429,2088.57142857143,2131.71428571429,2210.28571428571,2265.71428571429,2368.28571428571,2453.85714285714,2563.85714285714,2709.42857142857,2886.85714285714,3117.71428571429,3481.14285714286,3845.85714285714,4191.14285714286,4630.14285714286,5288.14285714286,6019.42857142857,6813.14285714286,7546.71428571429,8304.71428571429,8659.71428571429,9143.42857142857,9844.42857142857,10488.4285714286,10824.4285714286,10720.8571428571,9799.71428571429,10473.2857142857,11079.5714285714,10715,11648.7142857143,12361,12787.2857142857,13132,13384.5714285714,13382.2857142857,14318.2857142857,13558.1428571429,13020,12972,13511.4285714286,12812.2857142857,12005.5714285714,11193.2857142857,10519.1428571429,9915,9466.42857142857,9133.42857142857,8767,8469.85714285714,8007,7603.42857142857,7165.42857142857,6718.42857142857,6344.14285714286,6055.57142857143,5731.85714285714,5255.28571428571,4847.42857142857,4556.71428571429,4280.71428571429,3968.57142857143,3751.28571428571,3624.57142857143,3386.57142857143,3215.57142857143,3000.28571428571,2802,2621.28571428571,2466.71428571429,2340.28571428571,2126.85714285714,1943.57142857143,1776.85714285714,1630.42857142857,1510.71428571429,1414.14285714286,1348.28571428571,1288.42857142857,1222.42857142857,1159.14285714286,1111.14285714286,1075.85714285714,1066.42857142857,1045.85714285714,994.857142857143,954.857142857143,903.714285714286,839,781.142857142857,738.428571428571,700.714285714286,633.571428571429,596.571428571429,575.285714285714,555.285714285714,538.142857142857,523.857142857143,514.714285714286,516.285714285714,506.428571428571,499.142857142857,491.142857142857,492.571428571429,487.285714285714,480.571428571429,485.571428571429,473.714285714286,463,466.428571428571,456.428571428571,458.142857142857,471.571428571429,462.857142857143,458.714285714286,481.142857142857,477.714285714286,475.285714285714,464.428571428571,466.285714285714,447,430,386,369.142857142857,344.571428571429,336.142857142857,299.428571428571,276.857142857143,273.142857142857,278.428571428571,274.857142857143,289.142857142857,294.285714285714,305.714285714286,318,310.285714285714,299.571428571429,297.714285714286,290.571428571429,282.428571428571,292.142857142857,296.714285714286,305.428571428571,316.714285714286,317,307,307.428571428571,293.714285714286,284,274.285714285714,266.142857142857,251.428571428571,250.142857142857,242.428571428571,229.428571428571,221.142857142857,224.142857142857,221,232.714285714286,233.285714285714,234.571428571429,247,261.714285714286,259.714285714286,253.428571428571,248.857142857143,250.428571428571,251.714285714286,243.857142857143,242,247.142857142857,264,273.714285714286,277.428571428571,284.428571428571,293.285714285714,297.857142857143,310.285714285714,329.428571428571,356.142857142857,377.285714285714,397.428571428571,414.571428571429,431.571428571429,471.857142857143,517.857142857143,556.285714285714,594.571428571429,624.571428571429,662,734.857142857143,788.714285714286,824.285714285714,853.714285714286,887.428571428571,911.285714285714,925.714285714286,952.428571428571,980.428571428571,994.142857142857,1034.57142857143,1045.85714285714,1067.28571428571,1096.28571428571,1161.28571428571,1232.42857142857,1344.57142857143,1437.14285714286,1582.28571428571,1693.85714285714,1822.14285714286,1990.71428571429,2157.42857142857,2312.28571428571,2470,2593.85714285714,2727.71428571429,2830.14285714286,2965.42857142857,3109.28571428571,3308.57142857143,3390,3490.14285714286,3570.28571428571,3662.57142857143,3821.71428571429,4000.85714285714,4283.28571428571,4861,5349.71428571429,5604.85714285714,5775.57142857143,5936.14285714286,5911,5665.71428571429,5178,4725.42857142857,4448.71428571429,4219,3926.71428571429,3751.57142857143,3631.42857142857,3560.14285714286,3460.85714285714,3343,3030.71428571429],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,41,42,42.6666666666667,82,95.6,102.5,108.571428571429,124,122.714285714286,125.428571428571,134.571428571429,149.142857142857,160,171.714285714286,185.571428571429,189.285714285714,192.714285714286,218.285714285714,227.428571428571,242.571428571429,249.285714285714,252.142857142857,257.428571428571,257.285714285714,259.571428571429,264.428571428571,262.714285714286,264.285714285714,265.428571428571,261.571428571429,257.857142857143,250,237.285714285714,227.428571428571,213.428571428571,201,195.428571428571,193.142857142857,175.714285714286,164.714285714286,149.857142857143,142.857142857143,131.857142857143,131.857142857143,129,113.714285714286,105.714285714286,102.857142857143,98.4285714285714,95,93.4285714285714,93,88.2857142857143,79.2857142857143,72.7142857142857,62,59.4285714285714,58,55.7142857142857,46.4285714285714,43.7142857142857,40.4285714285714,42.7142857142857,38.4285714285714,38.4285714285714,38.2857142857143,34.4285714285714,32.7142857142857,30.4285714285714,26.1428571428571,23.2857142857143,22,21.8571428571429,18.2857142857143,16.7142857142857,14.4285714285714,13.4285714285714,13.8571428571429,14.1428571428571,14.5714285714286,14.7142857142857,14.2857142857143,14.2857142857143,14,13.4285714285714,13.2857142857143,12.7142857142857,12.5714285714286,11.5714285714286,10.4285714285714,10.5714285714286,8.42857142857143,8.14285714285714,7.85714285714286,5.71428571428571,4.71428571428571,4.85714285714286,5.14285714285714,6.42857142857143,6.42857142857143,6.71428571428571,7,9.28571428571429,9.42857142857143,8.42857142857143,7.28571428571429,7.28571428571429,7.14285714285714,6.57142857142857,3.71428571428571,3.14285714285714,4.28571428571429,4.57142857142857,4.71428571428571,4.57142857142857,4.28571428571429,4.42857142857143,4.28571428571429,3.14285714285714,2.85714285714286,3,3,2.42857142857143,3.85714285714286,3.71428571428571,3.28571428571429,3.42857142857143,3.42857142857143,3.71428571428571,4.14285714285714,3.14285714285714,3.57142857142857,3.42857142857143,3.28571428571429,3,2.71428571428571,2.57142857142857,1.71428571428571,1.42857142857143,1.28571428571429,1.28571428571429,1.42857142857143,1.42857142857143,1.42857142857143,1.85714285714286,2.71428571428571,2.71428571428571,2.57142857142857,2.42857142857143,2.42857142857143,1.85714285714286,1.71428571428571,1,1.42857142857143,2.14285714285714,2.28571428571429,2.28571428571429,2.42857142857143,2.28571428571429,2.14285714285714,1.85714285714286,0.857142857142857,0.714285714285714,0.714285714285714,0.714285714285714,1.14285714285714,1.28571428571429,1.14285714285714,1.42857142857143,1.42857142857143,1.42857142857143,1.85714285714286,1.28571428571429,0.857142857142857,0.857142857142857,0.714285714285714,0.714285714285714,0.857142857142857,1.28571428571429,1.28571428571429,1.57142857142857,2.57142857142857,2.57142857142857,2.57142857142857,2.42857142857143,2,2.28571428571429,2.42857142857143,1.71428571428571,1.85714285714286,2.14285714285714,2.14285714285714,2.42857142857143,2.85714285714286,3.14285714285714,3.14285714285714,3.42857142857143,3.14285714285714,3.28571428571429,2.85714285714286,3,2.71428571428571,3.71428571428571,3.71428571428571,4.33333333333333,5,5.5,5.33333333333333,6.5,4,null,null,null]],\"fixedtz\":false,\"tzone\":\"UTC\"},\"evals\":[\"attrs.interactionModel\"],\"jsHooks\":[]}\r\nFigure 1: COVID-19 deaths in London decouple from cases thanks to vaccinationData source: Public Health England / Office of National Statistics\r\n\r\n\r\n\r\nFishing\r\nThe following two charts depict the increase in intensity of fishing activity. The first chart is based on some amazing data put together by Global Fishing Watch. They trained a machine learning model to detect the amount of time and type of fishing activity in which vessels engage based on a combination of satellite and vessel tracking data. The image below shows the evolution of fishing hours for different fishing methods between 2012 and 2017. The second chart is based on FAO data of catches and shows that the global volume of catches has remained roughly stable since 1990. This slow down could be linked to the unsustainable level of fishing activity. FAO estimates that 94% of all fish stocks are currently overfished or fished at their maximum sustainable level.\r\n\r\n\r\n\r\nFigure 2: Fishing effort and total catchesData source: Global Fishing Watch\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 3: Total global fishing catchesData source: FAO\r\n\r\n\r\n\r\nFinancial shocks\r\nThese long time-series offer a snapshot of the number of financial crises in the world over the last 200 years. They show how financial shocks tend to be cyclical and globalisation lead to economies being synchronised across the world.\r\n\r\n\r\n\r\nFigure 4: Financial cycles from 1800Data source: Reinhart et al. (https://www.hbs.edu/behavioral-finance-and-financial-stability/data/Pages/global.aspx)\r\n\r\n\r\n\r\nEconomic activity and carbon emissions\r\nThe next three charts are about carbon emissions and their link with economic activity. The first chart shows a breakdown of emission by production stage for some of the main food and agriculture products. The data comes from a metadata analysis conducted by Nemecek and Poore (2018) and reveals a considerable heterogeneity across products.\r\n\r\n\r\n\r\nFigure 5: Breakdown of emissions from the food supply chainData source: Nemecek and Poore (2018)\r\n\r\n\r\n\r\nThe second chart shows the correlation between population and carbon emissions of European countries and is a reminder that we are all individually contributing to emissions. Countries above the trend line have a per capita consumption higher than the European average.\r\n\r\n\r\n\r\nFinally, the third chart shows the key role played by technological innovation in curbing emissions. The chart illustrates growth in carbon emissions between 1995 and 2009 for a selection of countries and contrasts it to a scenario in which emission intensity remained constant. I used data from GTAP on emissions and production by ISIC sector to compute the two scenarios.\r\n\r\n\r\n\r\nFigure 6: Growth of carbon emissions 1995-2009 with and without technological improvementData source: GTAP\r\n\r\n\r\n\r\nConflicts in history\r\nAnother long time-series. This time showing the number of active conflicts around the world over the last 600 years. Conclusion: humans have never been a peaceful species.\r\n\r\n\r\n\r\nClimate risks\r\nClimate change will bring an increase in extreme weather events, such as droughts, cyclones and floods. These will constitute an increasing threat, especially for more vulnerable developing countries. The following charts illustrate the increase in average global temperatures, natural hazards and the uneven exposures of countries to climate risks.\r\n\r\n\r\n\r\nFigure 7: Global warmingData source: HadCRUT4 (https://www.metoffice.gov.uk/hadobs/hadcrut4/index.html)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"10c82c741d86\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"10c82c741d86\",\"attrs\":{\"10c82c741d86\":{\"locations\":{},\"z\":{},\"colorscale\":[{\"z\":0,\"col\":\"#FEFDB6\"},{\"z\":0.2,\"col\":\"#FEFDB6\"},{\"z\":0.2,\"col\":\"#FFE402\"},{\"z\":0.4,\"col\":\"#FFE402\"},{\"z\":0.4,\"col\":\"#FFA203\"},{\"z\":0.6,\"col\":\"#FFA203\"},{\"z\":0.6,\"col\":\"#F90E1E\"},{\"z\":0.8,\"col\":\"#F90E1E\"},{\"z\":0.8,\"col\":\"#CB0033\"},{\"z\":1,\"col\":\"#CB0033\"}],\"colorbar\":{\"tickvals\":[1,2,3,4,5],\"ticktext\":[\"very low\",\"low\",\"medium\",\"high\",\"very high\"]},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"choropleth\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"zaxis\":{\"title\":\"as.numeric(WRI)\"}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5},\"geo\":{\"showframe\":true,\"showcoastlines\":true,\"coastlinecolor\":\"rgba(190,190,190,1)\",\"projection\":{\"type\":\"Mercator\"}}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"\",\"ticklen\":2,\"tickvals\":[1,2,3,4,5],\"ticktext\":[\"very low\",\"low\",\"medium\",\"high\",\"very high\"],\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[0,\"#FEFDB6\"],[0.2,\"#FEFDB6\"],[0.2,\"#FFE402\"],[0.4,\"#FFE402\"],[0.4,\"#FFA203\"],[0.6,\"#FFA203\"],[0.6,\"#F90E1E\"],[0.8,\"#F90E1E\"],[0.8,\"#CB0033\"],[1,\"#CB0033\"]],\"showscale\":true,\"locations\":[\"DMA\",\"ATG\",\"SLB\",\"GUY\",\"BRN\",\"PNG\",\"PHL\",\"GTM\",\"CPV\",\"CRI\",\"BGD\",\"DJI\",\"FJI\",\"KHM\",\"SLV\",\"KIR\",\"COM\",\"TLS\",\"NIC\",\"HTI\",\"NER\",\"GNB\",\"NGA\",\"CMR\",\"URY\",\"GMB\",\"JAM\",\"CHL\",\"TCD\",\"DOM\",\"BEN\",\"BFA\",\"HND\",\"TGO\",\"MLI\",\"MDG\",\"AGO\",\"KEN\",\"IDN\",\"BDI\",\"VNM\",\"CIV\",\"SEN\",\"JPN\",\"TTO\",\"SLE\",\"LBR\",\"GHA\",\"ZWE\",\"MOZ\",\"MUS\",\"TZA\",\"MWI\",\"COD\",\"AFG\",\"UGA\",\"GIN\",\"ALB\",\"SDN\",\"ECU\",\"PAN\",\"BLZ\",\"NLD\",\"VEN\",\"MRT\",\"UZB\",\"ETH\",\"ZMB\",\"CAF\",\"MYS\",\"FSM\",\"LKA\",\"RWA\",\"DZA\",\"SUR\",\"KGZ\",\"GNQ\",\"GRC\",\"MMR\",\"MNE\",\"COG\",\"ERI\",\"GAB\",\"LSO\",\"PAK\",\"COL\",\"IND\",\"THA\",\"SWZ\",\"ZAF\",\"PER\",\"NAM\",\"SYR\",\"IRQ\",\"MEX\",\"WSM\",\"ROU\",\"CUB\",\"CHN\",\"TJK\",\"MAR\",\"MKD\",\"ARM\",\"GEO\",\"AZE\",\"TUN\",\"YEM\",\"TKM\",\"SYC\",\"LBN\",\"SRB\",\"NZL\",\"HUN\",\"TUR\",\"IRN\",\"BRA\",\"BIH\",\"BOL\",\"NPL\",\"ITA\",\"LCA\",\"AUS\",\"IRL\",\"KWT\",\"LAO\",\"BHS\",\"BWA\",\"BGR\",\"JOR\",\"HRV\",\"MDA\",\"USA\",\"PRT\",\"ESP\",\"KAZ\",\"RUS\",\"ARG\",\"GBR\",\"SVN\",\"LBY\",\"PRY\",\"SVK\",\"ARE\",\"KOR\",\"AUT\",\"POL\",\"CZE\",\"LVA\",\"CYP\",\"MNG\",\"BTN\",\"ISR\",\"BHR\",\"CAN\",\"OMN\",\"UKR\",\"DNK\",\"BLR\",\"BEL\",\"DEU\",\"STP\",\"SGP\",\"NOR\",\"LUX\",\"FRA\",\"LTU\",\"SWE\",\"CHE\",\"MDV\",\"EST\",\"FIN\",\"EGY\",\"ISL\",\"BRB\",\"SAU\",\"GRD\",\"VCT\",\"MLT\",\"QAT\"],\"z\":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"type\":\"choropleth\",\"marker\":{\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nFigure 8: Exposure to natural hazardsData source: World Risk Report 2020\r\n\r\n\r\n\r\nInternational environmental agreements\r\nWe often talk of large multilateral environmental agreements: the Paris Agreement, the Montreal Prorocol on ODS, etc.. However, this is only the tip of the iceberg. There are hundreds of active environmental agreements. Most of these agreements involve a smaller number of countries engaging over regional issues. The two following charts offer a breakdown of over 3000 environmental agreements (data from the IEA database).\r\n\r\n\r\n\r\nFigure 9: International environmental agreements by subjectData source: IEA Database Project (https://iea.uoregon.edu/)\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 10: International environmental agreements by year and typeData source: IEA Database Project (https://iea.uoregon.edu/)\r\n\r\n\r\n\r\nEnvironmental policy\r\nThe following two charts are based on the WTO environmental database. This database tracks the environment-related measures notified to the WTO. It contains over 13000 measures and it is exceptional in its broad coverage of countries. As shown below, the number of notified environment-related measures is on the rise, but they are mostly being implemented in middle and high income countries.\r\n\r\n\r\n\r\nFigure 11: Number of environment-related measures notified to the WTOData source: WTO Environmental database (EDB)\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 12: Least developmed countries notify less environmental measures to the WTOData source: WTO Environmental database (EDB)\r\n\r\n\r\n\r\nUncertainty\r\nUncertainty on economic policy has always been around. But the last two years have brought uncertainty to an all new level. This is exactly what this index suggests based on wording frequency in newspaper articles published around the world.\r\n\r\n\r\n\r\nFigure 13: Policy uncertainty following the 2019 trade tensions and COVID-19Data source: Global Economic Policy Uncertainty Index\r\n\r\n\r\n\r\nEnergy\r\nWe often give access to electricity as granted, but a large portion of the world population currently lives without electricity. The first charts illustrates the relationship between income and access to electricity. The second chart shows the recent boom in adoption of solar and wind technologies for electricity generation. Once again, poorer nations are lagging behind due to high switching costs.\r\n\r\n\r\n\r\nFigure 14: Electricity access vs incomeData source: World BankNotes: Each point correspond to a coutry in 2017.\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 15: Uptake of solar and wind energy by income groupData source: BP Statistical Review of World Energy, World Bank.Notes: The figure shows GDP-weighted average of the share of solar and wind energy in the electricity mic\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-18-mishmash-of-charts/../../papers/map pictet.gif",
    "last_modified": "2022-05-14T16:36:32+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-11-16-the-world-trade-report-is-out/",
    "title": "The 2021 World Trade Report is out",
    "description": "I had the honour to contribute to the writing of this year's edition of the World Trade Report, the flagship economic publication of the World Trade Organization.  The report explores the role of trade, trade policy and international cooperation in building economic resilience in a world marked by increasing risks. In this article, I briefly outline my contributions on risk trends and policy responses to shocks.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-11-16",
    "categories": [
      "economics",
      "trade",
      "risk"
    ],
    "contents": "\r\n\r\nContents\r\nKey messages of the report\r\nMy contribution on risks and policy response\r\nThe launch of the report\r\n\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px}\r\n\r\n\r\nThe full 2021 World Trade Report is available here.\r\n\r\n\r\n\r\nKey messages of the report\r\nThe COVID-19 pandemic and the prospect of increasingly frequent and more intense natural and man-made disasters raise important questions about the resilience of the global economy to such shocks. The World Trade Report 2021 explores the role of trade, trade policy and international cooperation in building and supporting economic resilience.\r\nThe report conveys three main messages: first, today’s hyper-connected global economy, characterized by deep trade links, has made the world more vulnerable to shocks, but also more resilient to them when they strike; second, policies which aim to increase economic resilience by unwinding trade integration –– for example, by re-shoring production and promoting self-sufficiency — can often have the opposite effect, effectively reducing economic resilience; and third, strengthening economic resilience will require more global cooperation.\r\nMy contribution on risks and policy response\r\nI contributed to writing section B of the report. In particular, I authored the part exploring the sources and trends in risks, and the part on policy responses to shocks.\r\nIn the report, we highlight that risks are constantly evolving and are increasingly interlinked. For example, climate change is driving increases in extreme weather events, such as droughts, cyclones and floods, which can have devastating economic and social effects. Human encroachment on animal habitats can increase the risks of spreading zoonotic diseases, which could potentially lead to another pandemic. Although safer production processes have reduced the frequency of technological and industrial disasters, incidences of cyber-attacks and data fraud are expected to continue to increase. Rising inequality, increasing economic fragility, and growing political uncertainty and geopolitical tensions are augmenting the risk of conflicts and violence. While there is a tendency to look at these risks individually, they can interact with each other and create cascading risks.\r\nThese risks materialise into shocks which have considerable human, economic and environmental damages. The economic policy responses to shocks is usually aimed at cushioning the impact of the shocks. We can decompose economic disruption into: 1) demand shocks, 2) supply shocks and 3) increased uncertainty. In the the report we describe how different policies have been used to tackle these disruptions and note that shocks usually involve a combination of the three elements. Similarly, trade policy response is rarely entirely restrictive or liberalising. On the one hand, protectionism is seen as a way of prioritising domestic economic activity, while, on the the other hand, trade-opening often plays a crucial role in solving sudden demand-supply mismatches and emergency situations.\r\nThe launch of the report\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "https://www.wto.org/images/img_bkshop/wtr21_e.jpg",
    "last_modified": "2022-05-13T22:06:38+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-10-24-all-you-need-to-know-about-the-paris-agreement-ahead-of-cop26/",
    "title": "All you need to know about the Paris Agreement ahead of COP26",
    "description": "Only one week left to the official start of the COP26 in Glasgow, in which global leaders will meet to take crucial decisions on climate change. Scientific evidence shows that we are running out of time. If we wish to avoid the worst scenario, it's now or never. What will come out of the summit? Will it be a flop or a success? We don't know yet, but this article will quickly get you up to speed with climate talks.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-10-24",
    "categories": [
      "environment"
    ],
    "contents": "\r\n\r\nContents\r\nWhat is the Paris agreement?\r\nWait … what is climate change?\r\nGreat! We got an agreement. Everything is fine then?\r\nHow does the Paris agreement work?\r\nWhat is COP26 and why is it important?\r\n\r\nWhat is the Paris agreement?\r\nIf you haven’t heard of the Paris agreement you probably just came back from an interplanetary trip, awoke from hibernation experiment, or remained stranded on an island with no means of communication with the outside world for at least six years. So, let me congratulate you for making it here! We are happy to have you back!\r\nDuring your absence, country delegates gathered in Paris to sign a new agreement on climate change. Its goal is simply stated: limit the increase in average temperature to levels “well below 2°C above pre-industrial levels”. While the goal is simply stated, it is not simply reached. Climate change has been called the biggest challenge that humanity has to face.\r\nWait … what is climate change?\r\nIf you haven’t heard of this one, you might have been away longer than you think. Although I think you might have more pressing questions to attend, I won’t leave a question unanswered: Climate change refers to a lasting change in the temperature and weather patterns around the world. Most of human activities directly or indirectly generate greenhouse gases (GHG), such as carbon dioxide or methane, which trap heat in the atmosphere. An increase as small as 2°C in global average temperature is enough to create disruptive changes around the world. Torrential rainfalls, severe droughts, food insecurity, melting glaciers, biodiversity loss, flooding and rise of sea levels are just some of the unpleasant events that scientists have associated with climate change. In short: climate change effects are bad, and the risks and costs associated with it are not fully understood. We should definitively try to avoid it! And that’s what the Paris agreement is meant for. The idea is to avoid these catastrophic events by limit GHG emissions as much as possible and adapting to these changes.\r\n\r\n\r\n\r\nFigure 1: Temperature trend over the last 160 years Source: IPCC 2019 special report on Global warming of 1.5°C\r\n\r\n\r\n\r\nGreat! We got an agreement. Everything is fine then?\r\nAlas, it’s too early to celebrate. We already had two big agreements on climate change: the 1992 UN Framework Convention on Climate Change (UNFCCC), which established the institutions and principles for cooperation on climate change, and the 1997 Kyoto Protocol, which imposed binding emission reduction targets on a handful of developed nations. Yet, judging from the trend in CO\\(_2\\) concentration in the figure below, they were not terribly effective at stopping climate change. If they had, we would not be writing about a third agreement on the same issue.\r\n\r\n\r\n\r\nFigure 2: CO2 concentration in the atmosphere Source: Global Carbon Budget 2020\r\n\r\n\r\n\r\nAdmittedly, our track record is not exceptional. However, this time might be different. The Paris agreement started very well. The international community signalled a strong political engagement by allowing the Paris agreement to enter into force in 2016, just 30 days after it was open for signature — this is impressive given that it took eight years for the ratification and entry into force of the Kyoto Protocol. A crucial role in its early adoption was played by the prompt ratification of the United States — which later decided to pull-out of the agreement, and then again to rejoin it — and China during a joint ceremony. These are the two biggest GHG emitters in the world. To date, 197 countries have signed the agreement, and 190 ratified it. What’s more, the Paris agreements asks all its participants to contribute to reducing emissions by making pledges (more on this in a minute). This is essential because successful climate action requires global engagement and most of GHG emissions growth will take place in developing countries.\r\nWe can call it a good start, but the truth is that all the work still lies ahead. The figure below shows the projected global warming in a scenario in which we reach net zero emissions by 2030 (resulting in 1.5°C warming) and by 2055 (2°C warming). Reaching net zero emissions means that, on balance, the amount of GHG released in the atmosphere needs to be no larger than the GHG removed from the atmosphere. Considering that we emit about 50bn tonnes of CO\\(_2\\)-equivalent GHG, this is no small task! And achieving neutrality before 2030 (or even 2055) is definitively a challenge. One thing is certain: the earlier we act, the more likely we are to succeed.\r\n\r\n\r\n\r\nFigure 3: Paths towards Paris agreement’s goal Source: IPCC 2019 special report on Global warming of 1.5°C\r\n\r\n\r\n\r\nHow does the Paris agreement work?\r\nOverall the experience of the Kyoto Protocol was rather negative. Negotiations were arduous, the protocol engaged only a small number of countries, the entry into force was extremely slow, and its effectiveness in curbing emissions is debatable. Therefore, negotiators decided to opt for a totally different approach for the Paris Agreement. The system introduced by the Paris agreement has a two-layer structure:\r\nA common binding ground that regulates the assessment process and basic formal requirements on accounting and communication of GHG emissions;\r\nA flexible target setting for participants, in which each country is free to establish its objectives and the way it proposes to achieve them. The self-determined goals are called Nationally Determined Contribution (NDC).\r\nThe agreement sets no binding emission targets for the participants and the ratifiers incur no sanction if they do not fulfil their NDC. However, the monitoring and reporting process is binding. In addition, every five years the parties must update their NCDs objectives, which must represent a progress toward the target of the agreement and reflect the “highest possible ambition” (Article 4, Paris Agreement). As of now, the reduction in emissions implied by the sum of all pledges is unable to ensure that the objective of “well below 2°C”is met (see Figure below). However, 2021 marks the fifth year from the entry into force of the agreement. Hence, it’s now time to submit new, more ambitious pledges. Many of these new pledges have already been submitted in the past weeks. You can check out the Climate action tracker website for an overview of NDC submissions.\r\n\r\n\r\n\r\nFigure 4: Current pledges fall short of Paris agreeement’s target Source: Our World in Data\r\n\r\n\r\n\r\nAnother feature of the Paris agreement is that it allows countries to pay for carbon emissions to be reduced abroad and counting these reductions towards its own national targets. This should allow to cut the costs of climate action by curbing emissions where it is most efficient. Finally, the agreement also creates financial mechanisms to support developing countries in meeting their goals. In particular, developed nations promised to provide 100 billion dollars annually from 2020 to 2025 to support the agreement.\r\nWhat is COP26 and why is it important?\r\nEvery year, countries that are members to the UN Framework Convention on Climate Change and the Paris agreement meet to assess their progress and take decisions regarding the implementation of the agreement. The fancy name of these meetings is “Conference of the Parties” — COP for short. This year’s COP will take place in Glasgow and it is the 26th edition of COP (hence COP26).\r\nThis edition is important for multiple reasons. First, this edition marks five years from the entry into force of the agreement. Hence, we should expect new pledges and big announcements, which will provide a guidance for the next five years of implementation. For example, we might expect joint pledges on deforestation, renewable energy and electric cars. Secondly, there are still some sticking points in the implementation rules which need to be negotiated. For example, members still need to define the highly contentious issue of how the carbon trading mechanisms will work in practice. Finally, we also need to find the money for climate action. At the moment, we are still a bit short of the 100bn rich countries had promised to provide by 2020.\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-10-24-all-you-need-to-know-about-the-paris-agreement-ahead-of-cop26/pexels-pixabay-221012.jpg",
    "last_modified": "2021-12-18T22:44:50+01:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-15-pandemic-and-the-office-space-market/",
    "title": "How has the pandemic affected the office space market?",
    "description": "In this post I have a look at data from the City of London to understand how the pandemic has impacted the office market.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-08-15",
    "categories": [
      "economics"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px}\r\n\r\n\r\nClick here to open the data dashboard.\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-15-pandemic-and-the-office-space-market/city2_preview.jpg",
    "last_modified": "2021-12-18T22:42:46+01:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-07-08-the-fascinating-world-of-voronoi-diagrams/",
    "title": "The fascinating world of Voronoi diagrams",
    "description": "In this article I explain what is a Voronoi diagram and why they are amazing",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-07-08",
    "categories": [
      "maths",
      "other"
    ],
    "contents": "\r\n\r\nContents\r\nWhat is a Voronoi diagram?\r\nVoronoi patterns are ubiquitous\r\nVoronoi patterns in nature\r\nVoronoi pattern in architecture and arts\r\n\r\nMathematical definition and some interesting properties\r\nDelaunay triangulation\r\nLloyd’s relaxation algorithm\r\nHow to construct Voronoi diagrams?\r\nLinks to additional material\r\n\r\n\r\n\r\n\r\nVoronoi diagrams (also known as Dirichlet tesselation or Thiessen polygons) are everywhere in nature. You have encountered them thousands of times, but maybe did not call it this way. Voronoi diagram are simple, yet they have incredible properties which have found applications in fields ranging from cartography, biology, computer science, statistics, archaeology, all way to architecture and arts.\r\nWhat is a Voronoi diagram?\r\nSuppose you have \\(n\\) points scattered on a plane, the Voronoi diagram of those points subdivides the plane in exactly \\(n\\) cells enclosing the portion of the plane that is the closest to the each point. This produces a tessellation that completely covers the plane. As an illustration, in Figure 1, I plotted 100 random points and their corresponding Voronoi diagram. As you can see, every point is enclosed in a cell, whose boundaries are exactly equidistant between two or more points. In other words, all the area enclosed in the cell is closest to the point in the cell than to any other point.\r\n\r\n\r\n\r\nFigure 1: Voronoi diagram from 100 random points in a plane\r\n\r\n\r\n\r\nVoronoi patterns are ubiquitous\r\nVoronoi patterns in nature\r\nThe pattern created by Voronoi diagrams is a common one in nature. In Figure 3, I made a small collage of some naturally occurring Voronoi-like patterns. From microscopic cells in onion skins, to the shell of jackfruits and the coat of giraffes. These patterns are everywhere!\r\nA first reason for their omnipresence is that they form efficient shapes. As we mentioned earlier, Voronoi diagram completely tessellates the plan: hence, all space is used. This is very convenient if you are trying to squeeze as much as possible in a limited space — such as in muscle fibres or bee hives. Secondly, Voronoi diagrams are a spontaneous pattern whenever something is growing at a uniform growth rate from separate points (see Figure 2). For instance, this explains giraffe exhibit such patterns. Giraffe embryos have a scattered distribution of melanin-secreting cells, which is responsible for the dark pigmentation of the giraffe’s spots. Over the course of the gestation these cells release melanin — hence spots radiate outward. Interested reader may refer to this paper, in which the authors use Voronoi diagrams to model computer rendering of spots on animals coats.\r\n\r\n\r\n\r\nFigure 2: A Voronoi diagram is obtained from constant outward growth from dispered pointsSource: Wikipedia\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 3: Voronoi patterns are everywhere in nature. (From top-left to bottom right: microscope view of onion skin cells, cross-section of a muscle, garlic bulb, wings of a dragonfly, soap bubbles, close-up of a leaf, giraffes coat patterns, corns, jackfruits hanging from a tree.)\r\n\r\n\r\n\r\nVoronoi pattern in architecture and arts\r\nPerhaps because of their spontaneous “natural” look, or simply because of their mesmerising randomness, Voronoi patterns have intentionally been implemented in human-made structures. An architectural example is the “Water cube” built to house the water sports during the 2008 Beijing Olympics. It features Voronoi diagrams on its ceiling and façades (Figure 4). The Voronoi diagrams were chosen because they recall bubbles1. This analogy is very clear at night, when the entire façade is illuminated in blue and comes alive.\r\n\r\n\r\n\r\nFigure 4: Water cube in Beijing\r\n\r\n\r\n\r\nBut Chinese appreciation of Voronoi pattern is surely older than this building. Guan and Ge ware from the Song dynasty have a distinctive crackled glaze. Ceramics can easily crack during the cooling process, however the crackles from the Guan and Ge ware are different — they are intentional. They are sought after because of their aesthetic qualities. Thanks to the Voronoi-like patterns on their surface, each piece is unique. To date, this is one of the most imitated styles of porcelain (Figure 5).\r\n\r\n\r\n\r\nFigure 5: Guan and Ge wares\r\n\r\n\r\n\r\nVoronoi diagrams are also common in graphic arts for creating “abstract” patterns. I think they make excellent background images. For example, I created the thumbnail of this post by generating random points and constructing a Voronoi diagram. Then, I coloured each cell based on the distance of its point from a randomly selected spot in the box (Figure 6). Endless “abstract” backgrounds images could be generated this way.\r\n\r\n\r\n\r\nFigure 6: Coloured Voronoi diagram\r\n\r\n\r\n\r\nMathematical definition and some interesting properties\r\nSo far, we have presented a simple two-dimensional Voronoi diagram. However, the same type of structure can be generalised to an \\(n\\)-dimensional space. Suppose \\(P=\\{p_1,p_2,...,p_m\\}\\) is a set of \\(m\\) points in our n-dimensional space. Then, the space can be partitioned in \\(m\\) Voronoi cells, \\(V_i\\), containing all points in \\(\\mathbb{R}^n\\) that are closer to \\(p_i\\) than to any other point.\r\n\\[V_i = \\left\\{x : \\forall j \\neq i, d(x, p_i) \\leq d(x,p_j)\\right\\} \\text{, with } i,j \\in \\{1,2,...,m\\}\\] Where the function \\(d(x,y)\\) gives the distance (\\(a\\)) between its two arguments. Typically, the Euclidean distance is used (\\(l^2\\) distance):\r\n\\[d(x,y)=||x-y||_2=\\sqrt{\\sum_{k=1}^{n}(x_k-y_k)^2}\\] However, Voronoi diagrams could be designed using other distance functions. For instance, Figure 7 shows a Voronoi diagram obtained with the Manhattan or cityblock distance (\\(l^1\\) distance). The Manahattan distance is the distance between two points if you had to follow a regular grid — such as the city blocks of Manhattan. The result is a more “boxy” Voronoi diagram. \\[d(x,y)=||x-y||_1=\\sum_{k=1}^{n}{|x_k-y_k|}\\]\r\n\r\n\r\n\r\nFigure 7: Euclidean and Manhattan distanceSource:Johnson Hsieh\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 8: Comparison of Voronoi diagrams using the Euclidean (left) and Manhattan (right) distance for a same set of pointsSource: Wikipedia\r\n\r\n\r\n\r\nEuclidean distance is the most common distance measure in scientific applications of the Voronoi diagram. It also has the advantage of generating Voronoi cells that are convex. That is to say, if you take any two points within a cell, the line that connects the two points will lie entirely within the cell.\r\nFinally, it should also be noted that Voronoi diagrams are tightly linked with the k-nearest neighbours algorithm (k-NN) — a very popular algorithm in classification, regression and clustering problems. The algorithm uses the \\(k\\) closest examples in the training dataset to make value predictions. Since the Voronoi diagrams partitions the space in polygons containing the closest points to each seed, the edges of Voronoi cells correspond exactly to the decision boundaries of a simple 1-nearest neighbour problem.\r\nDelaunay triangulation\r\nIf you take each of the points from a Voronoi diagram and link it with the points in its neighbouring cells, you will obtain a graph called Delaunay triangulation. In mathematical terms, the Delaunay triangulation is the dual graph of the Voronoi diagram. In the Figure below, a Voronoi diagram (black) and Delaunay triangulation (grey) is plotted from a set of points. By moving the mouse over the image, one can explore how they are affected by a new point.\r\n\r\n\r\n\r\n{\"x\":{\"data\":null,\"type\":\"NULL\",\"container\":\"svg\",\"options\":null,\"script\":\"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\\nthis.d3 = d3;\\n\\nsvg = d3.select(svg.node());\\n/* R2D3 Source File:  d3/voronoi.js */\\n// !preview r2d3 d3_version = 4\\n\\n// Based on: https://bl.ocks.org/mbostock/4060366\\n\\nsvg.on(\\\"touchmove mousemove\\\", moved);\\n\\nvar sites = d3.range(100)\\n    .map(function(d) { return [Math.random() * width, Math.random() * height]; });\\n\\nvar voronoi = d3.voronoi()\\n    .extent([[-8, -8], [width + 8, height + 8]]);\\n\\nvar polygon = svg.append(\\\"g\\\")\\n    .attr(\\\"class\\\", \\\"polygons\\\")\\n  .selectAll(\\\"path\\\")\\n  .data(voronoi.polygons(sites))\\n  .enter().append(\\\"path\\\")\\n    .call(redrawPolygon);\\n\\nvar link = svg.append(\\\"g\\\")\\n    .attr(\\\"class\\\", \\\"links\\\")\\n  .selectAll(\\\"line\\\")\\n  .data(voronoi.links(sites))\\n  .enter().append(\\\"line\\\")\\n    .call(redrawLink);\\n\\nvar site = svg.append(\\\"g\\\")\\n    .attr(\\\"class\\\", \\\"sites\\\")\\n  .selectAll(\\\"circle\\\")\\n  .data(sites)\\n  .enter().append(\\\"circle\\\")\\n    .attr(\\\"r\\\", 2.5)\\n    .call(redrawSite);\\n\\nfunction moved() {\\n  sites[0] = d3.mouse(this);\\n  redraw();\\n}\\n\\nfunction redraw() {\\n  var diagram = voronoi(sites);\\n  polygon = polygon.data(diagram.polygons()).call(redrawPolygon);\\n  link = link.data(diagram.links()), link.exit().remove();\\n  link = link.enter().append(\\\"line\\\").merge(link).call(redrawLink);\\n  site = site.data(sites).call(redrawSite);\\n}\\n\\nfunction redrawPolygon(polygon) {\\n  polygon\\n      .attr(\\\"d\\\", function(d) { return d ? \\\"M\\\" + d.join(\\\"L\\\") + \\\"Z\\\" : null; });\\n}\\n\\nfunction redrawLink(link) {\\n  link\\n      .attr(\\\"x1\\\", function(d) { return d.source[0]; })\\n      .attr(\\\"y1\\\", function(d) { return d.source[1]; })\\n      .attr(\\\"x2\\\", function(d) { return d.target[0]; })\\n      .attr(\\\"y2\\\", function(d) { return d.target[1]; });\\n}\\n\\nfunction redrawSite(site) {\\n  site\\n      .attr(\\\"cx\\\", function(d) { return d[0]; })\\n      .attr(\\\"cy\\\", function(d) { return d[1]; });\\n}\\n};\",\"style\":\"/* R2D3 Source File:  d3/voronoi.css */\\n.links {\\n  stroke: #000;\\n  stroke-opacity: 0.2;\\n}\\n\\n.polygons {\\n  fill: none;\\n  stroke: #000;\\n  stroke-opacity: 1;\\n}\\n\\n.polygons :first-child {\\n  fill: #f00;\\n  fill-opacity: 0.4;\\n}\\n\\n.sites {\\n  fill: #000;\\n  stroke: #fff;\\n}\\n\\n.sites :first-child {\\n  fill: #fff;\\n}\",\"version\":4,\"theme\":{\"default\":{\"background\":\"#FFFFFF\",\"foreground\":\"#000000\"},\"runtime\":null},\"useShadow\":true},\"evals\":[],\"jsHooks\":[]}\r\nFigure 9: Voronoi diagram and Delaunay triangulationSource: r2d3\r\n\r\n\r\n\r\nDelaunay triangulation is just as amazing as Voronoi diagrams. As the name suggests, it produces a set of triangles linking our points. These triangles are such that if one were to draw a circle across the vertices of these triangles, there would be no other point inside the circle (See Figure 10). Moreover, Delaunay triangulation also has the property of maximising the smallest angle of in the triangles of the triangulation. Hence, Delaunay triangulation tends to avoid triangles with acute angles.\r\n\r\n\r\n\r\nFigure 10: Delaunay triangles are constructed such that no point falls inside the circle circumscribing each triangleSource: Wikipedia\r\n\r\n\r\n\r\nThese properties make it very useful in modelling surfaces and objects from a set of points. For instance, the Delaunay triangulation is used to generate meshes for the finite element method and in facial recognition, construct 3D models for computer animations and model terrain in GIS analysis.\r\n\r\n\r\n\r\nFigure 11: Delaunay triangulation is used to produce meshes for facial recognitionSource: Learn OpenCV\r\n\r\n\r\n\r\nLloyd’s relaxation algorithm\r\nLlyod’s algorithm is a useful algorithm related to Voronoi diagrams. The algorithm consists in repeatedly alternating between constructing Voronoi diagrams and finding the centroids (i.e. center of mass) of each cell (See Figure 12). At each iteration, the algorithm spaces the points apart and produces more homogeneous Voronoi cells.\r\n\r\n\r\n\r\nFigure 12: Steps in Lloyd’s relaxation algorithm\r\n\r\n\r\n\r\nAfter a few iterations, the cells will already have a “rounder” aspect and points will be more evenly distributed. This is illustrated in the figure below, in which I have plotted the first 30 iterations of the Lloyd’s algorithm for a random set of points. For each point, I also record their starting position (grey hollow circle) to better trace the movement of each cell. For high number of iterations, the diagram tends to converge towards a stable Voronoi diagram in which every seed is also the centroid of the cell — also known as the centroidal Voronoi diagram. Interestingly, in 2D, Voronoi cells will tend to turn into hexagons because they provide the most efficient way of of packing shapes in a plane. As any bee building their hive can certify, hexagonal cells have two big advantages: 1) they ensure no empty space is left between cells (i.e. tessellates the plane), and 2) hexagons offer the highest ratio between surface and perimeter of the cell. This so-called Honeycomb conjecture, took mathematicians two-thousand years to prove.\r\n\r\n\r\n\r\nFigure 13: 30 iterations of the Lloyd’s algorithm\r\n\r\n\r\n\r\nIn data science, Lloyd’s algorithm is at the basis of k-means clustering — one of the most popular clustering algorithms. k-means clustering is typically initiated by taking \\(k\\) random “centroids” in space. Then, data points are grouped in \\(k\\) clusters by alternating between 1) assigning data points to the closest “centroid” (this is equivalent to building a Voronoi diagram for the centroid and checking which point are inside the cell) and 2) updating the centroid by calculating the mean of the points inside each cell (See Figure 14).\r\n\r\n\r\n\r\nFigure 14: k-means clusteringSoruce: Wikipedia\r\n\r\n\r\n\r\nBesides data science, Lloyd’s algorithm is used in a variety of applications. For instance, it is very common in quantization and lossy data compression algorithms (e.g. Lloyd-Max algorithm). It is also very useful whenever one wants random points that are nicely spaced. For instance, it could be used to smooth meshes generated from the Delaunay triangulation, for dithering images, or as a basis for procedural maps generation in video games.\r\nHow to construct Voronoi diagrams?\r\nOne could construct Voronoi diagrams by building each cell one by one. If one extends the bisector of the segments linking every combination of points, it is possible to obtain the outline of Voronoi cells (Figure 15). However, this technique is quite inefficient. Considering there are \\(\\frac{1}{2}(1-n)n\\) combinations of points, the complexity of such algorithm would increase quadratically with the number of points.\r\n\r\n\r\n\r\nFigure 15: Construction of Voronoi cellsSource: Roberto Tamassia\r\n\r\n\r\n\r\nMore efficient alternatives have been proposed. For example, the Sweep line algorithm builds Voronoi cells progressively by sequentially using binary search tree and priority queue operations (Figure 16). A good description of this algorithm can be found here. Another way of constructing Voronoi diagrams, is to first build Delaunay triangulations. Once the triangulation is obtained, extending the bisectors of the triangle edges leads to the Voronoi diagram (Figure 17). Delaunay triangulation can be obtained without the need of considering every pair of points. For instance, an efficient technique consists in projecting the points on a paraboloid in a higher dimension. Re-projecting back the convex hull onto the original space gives the Delaunay triangulation (Figure 18)\r\n\r\n\r\n\r\nFigure 16: Sweep line algorithmSource: Wikipedia\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 17: Construction of Voronoi diagramsSource: Giulia Andreucci\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 18: Using the convex hull method for constructing Delaunay triangulationSource: Danny Sleator\r\n\r\n\r\n\r\nA discussion of different algorithms for computing Voronoi diagram and their complexity is available here, here, and here. New algorithms are continuously being proposed to improve computation efficiency in different circumstances (e.g. Yan et al. 2011, Qin et al. 2017). There are also techniques requiring constant time that generate approximate Voronoi diagrams (e.g. Jump flooding algorithm).\r\nLinks to additional material\r\nThis article tells the story of how Voronoi diagrams were used by John Snow to show the link between water pumps and the transmission of Cholera during the 1854 London outbreak.\r\nAmil Patel has a phenomenal blog on game development. I highly recommend his posts on procedural map generation with Voronoi diagrams.\r\nThis post by David Austin gives a great explanation of the Sweep line algorithm for computing Voronoi diagrams.\r\nThis nice looking map by Jason Davies is a Voronoi diagram of the location of airports around the world.\r\nSpatial Tessellations: Concepts and Applications of Voronoi Diagrams is a bible on Voronoi diagrams. If you have any doubt about Voronoi diagrams, you will certainly find an answer here.\r\nThese slides from Vincent Legat have some beautiful drawings for different construction algorithms.\r\nVoronoi diagrams are commonly used to model trees in forests (e.g. Abellanas et al. 2016, Bohler et al. 2018).\r\nVoronoi diagrams can also be used to determine robot’s paths. Check these articles: article 1, article 2.\r\nVoronoi diagrams have thousand of applications. From modelling trees in a forest to planning robot paths. In this article I barely scratched the surface. These links contain lists of interesting applications: link 1, link 2, link3, link4, link 5.\r\n\r\nTo be more precise, the “Water cube” patterns are inspired from Weaire-Phelan bubbles. However, these are directly obtainable as Voronoi diagram.↩︎\r\n",
    "preview": "posts/2021-07-08-the-fascinating-world-of-voronoi-diagrams/voronoi_animation2.gif",
    "last_modified": "2022-05-24T22:01:21+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-06-20-a-package-for-country-data/",
    "title": "A package for country data",
    "description": "I am working on an R package designed to quickly wrangle, merge and explore country data",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-06-20",
    "categories": [
      "coding"
    ],
    "contents": "\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}\r\n\r\n\r\nThe development version of the package is available here.\r\n\r\n\r\n\r\nAs an economist, I often work with country-level data coming from different sources. GDP series from the IMF, monetary data from central banks, trade data from WTO, CO2 emissions from the IEA, survey data from national agencies, etc.. Pooling all this data together is often a laborious task because countries’ naming conventions are never the same.\r\nTo make things easier, I am writing an R package to deal with this type of data. Ideally, the user should be able to merge country data files with a unique line of command. The package will offer functionalities to:\r\nConvert country names to a common nomenclature (e.g. M49 standard or ISO-3 codes)\r\nTranslate country names to different languages\r\nMerge country data in a unique table by recognising and matching different country nomenclatures\r\nSupport the merging of country data with multiple identifiers (e.g. panel data or country-sector data)\r\nEasily download and merge data from online public data (e.g. World Bank data, FRED, etc.)\r\nAutomatically generate interactive visualisations to explore country data\r\n\r\n\r\n\r\n",
    "preview": "https://cdn.britannica.com/13/129613-131-30279F20/Flags-world-flags-Country-history-blog-travel-2009.jpg",
    "last_modified": "2022-01-11T11:26:28+01:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-04-03-tilemaster-a-strategy-game-in-shiny/",
    "title": "TileMaster: a strategy game in Shiny",
    "description": "I created a small strategy game with RStudios' Shiny platform. If it can run a data dashboard, why not a strategy game?",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-04-03",
    "categories": [
      "coding"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px}\r\n\r\n\r\nClick here to open the game Tile master in your browser. The complete code of the shiny app is available on Github.\r\n\r\n\r\n\r\nAfter a look at the amazing gallery of dashboards and interactive data visualisations from Shiny apps, I decided that I had to explore its functionalities by trying a project on my own.\r\nShiny allows R users to quickly build and share simple apps that run on browsers. They are ideal for data visualisation. It is really easy to create interactive charts and combine them in a beautiful dashboards. So why not trying to plot some interesting economic data? I should have thought about this a bit longer. For some inexplicable reason, I decided it would be interesting to implement a strategy board game on a shiny app.\r\nIt was a challenging project. It took some time, and a lot more coding than originally planned, but eventually I managed to implement a playable game with Shiny. For the moment I didn’t write down the games’ rules and didn’t include a tutorial. So, if you don’t mind figuring the rules out by trial and error, feel free to give it a try! No fun is guaranteed.\r\nThis game was an enriching journey. I ended up exploring all sorts of unexpected subjects: from path finding algorithms and Delaunay triangulation to advanced game developing concepts. I also thoroughly enjoyed building the AI for this game. Given the strategic complexity of the game — and being the first AI I ever built — I am quite pleased with the final result. I experimented with different AI approaches, programmatic, machine learning and hybrids. In its final version, the basic AI decision process is a hybrid between a finite-state machine and a utility-based system. I then improved it by training machine learning models to evaluate the AI’s moves.\r\nI implemented many functionalities in the app. Users can save and load games, generate random maps with customisable parameters, select AI difficulty level and even play in a shared-screen multiplayer mode. In the end, it was a great learning project!\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-03-tilemaster-a-strategy-game-in-shiny/../../images/tilemaster_screenshot.png",
    "last_modified": "2022-01-11T11:53:14+01:00",
    "input_file": {},
    "preview_width": 1599,
    "preview_height": 1531
  },
  {
    "path": "posts/2021-03-20-how-to-increase-participation-in-environmental-agreements/",
    "title": "How to increase participation in environmental agreements?",
    "description": "Understanding the determinants of participation in environmental agreements can help us frame more successful agreements. In this article, I discuss the economic theory and empirical evidence on this topic.",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-03-20",
    "categories": [
      "environment",
      "economics"
    ],
    "contents": "\r\n\r\nContents\r\nEnvironmental agreements and economic theory\r\nEmpirical evidence\r\n\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}\r\n\r\n\r\n\r\nFigure 1: Number of multilateral environmental agreements by year Data from Mitchell (2020)\r\n\r\n\r\n\r\nThe world is facing significant environmental challenges, most of which are transboundary. Air pollution, contamination of lakes and rivers, global warming, biodiversity loss, deforestation, desertification, or overfishing are all problems that cross national borders and require international cooperation. Currently, the primary cooperative tools at our disposal are international environmental agreements, such as the Paris agreement on climate change, the CITES agreement on the trade of endangered species, or the Montreal protocol on ozone-depleting substances.\r\nOver the last fifty years, the number of environmental agreements has exploded (Figure 1). To date, more than 3,000 environmental agreements have been identified (Mitchell 2020) embodying cooperation on the most disparate environmental issues (Figure 2). Some agreements are successful, while others fail. Some attract universal participation, while others die on the negotiation table. Now more than ever, environmental agreements play a crucial role in improving environmental protection worldwide. Hence, the following questions are of great interest to economists: What motivates participation in environmental agreements? How can participation in environmental agreements be increased? Is there any factor at the national level that systematically enhance participation rates? If so, how can policy makers intervene to improve the likelihood of solving transboundary and global environmental issues?\r\n\r\n\r\n\r\nFigure 2: Number of agreements by subject Data from Mitchell (2020)\r\n\r\n\r\n\r\nEnvironmental agreements and economic theory\r\nThese questions have been addressed in economic research mostly using game-theoretical approaches in models that predict both the optimal emission abatement and participation levels in international agreements. In these models, countries contend with a considerable incentive to free-ride because the benefits of the agreement are usually considered non-excludable and non-rival. Hence, the conclusions of classic game-theoretical models are generally pessimistic on the capacity to solve environmental problems. In these models, wide participation in agreements can only be achieved with low abatement targets that fall short of the social optimum. This outlook originates from the core assumptions of these models, which frame treaty participation as a one-off non-cooperative choice — just like in a prisoner’s dilemma.\r\nLater works largely confirmed the free-riding incentive existing in treaty participation, with some improvement in the participation outlook. For example, participation can be improved if participants can offer side transfers. Under the right circumstances also the inclusion of penalties, trade restriction, minimum participation rules and permit trading schemes can considerably boost participation. Moreover, in repeated games — which allow countries to join the agreement in different moments — the result are generally more optimistic than in one-off games.\r\nEmpirical evidence\r\nThanks to the collection of large catalogues of environmental agreements (e.g. Mitchell 2020; CIESIN 2013), scholars can now look at these questions from an empirical perspective. Several findings emerge from this line of enquiry.\r\nFirst of all, the success of an agreement depends primarily on its content. This is by far the most important factor. More stringent agreement tend to deter participation, but there are some type of clauses (e.g.monitoring and enforcement rules, minimum participation rules, technological transfers, financial assistance) which can deliver stronger environmental commitment without penalising participation. Moreover, in Bellelli, Scarpa, and Aftab (2021), I show that regional agreements attract consistently higher ratification rates — on average the probability of joining a regional agreement is 2.5 times higher than for international agreements.\r\n\r\n\r\n\r\nFigure 3: Number of IEA ratifications by 2017 Data from Bellelli, Scarpa, and Aftab (2021)\r\n\r\n\r\n\r\nSo, design of the agreement matters. But this does not tell the whole story. As shown in the map above, participation varies not only between environmental agreements, but also between countries. And these differences are not random, rather, they seem to be clustered geographically, suggesting that political and economic factors are at play. The level of income, the quality of political institutions, the trade profile of the country, electoral and constitutional rules, the economic interests of domestic agents, are all factors that may influence a countries’ participation in international agreements.\r\nFinally, participation choices are seen as a strategic moves, which do not only depend on the characteristics of the country and treaty, but also on the behaviour of foreign nations. While we would theoretically expect a free-riding attitude, empirical evidence suggests that free-riding incentives are mitigated by the presence of international linkages. Empirical findings show that ratification likelihood increases when foreign nations decide to participate in treaties. This is particularly true in the case of large nations and countries that are in the same geographical area or income bracket. The empirical literature agrees that this effect is partly explained by the existence of economic and political ties between countries, which create interdependence and reputational costs for non-participation.\r\n\r\nMore information on this topic may be found in:\r\nBellelli, F.S., Scarpa, R. and Aftab, A. (2021) The joining dilemma: A survey of the empirical literature on environmental treaty participation. Review of Environmental Economics and Policy. (Forthcoming) PDF Appendix\r\nBellelli, F.S., Scarpa, R. and Aftab, A. Interest groups and participation in international environmental agreements. Working paper. Available from https://fbellelli.com/research.html. PDF\r\n\r\n\r\n\r\n\r\nBellelli, Francesco Saverio, Riccardo Scarpa, and Ashar Aftab. 2021. “Interest Groups and Participation in International Environmental Agreements.” Working Paper.\r\n\r\n\r\nCIESIN. 2013. “Environmental Treaties and Resource Indicators (ENTRI).” Center for International Earth Science Information Network.\r\n\r\n\r\nMitchell, R. B. 2020. “International Environmental Agreements Database Project.” University of Oregon.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-03-20-how-to-increase-participation-in-environmental-agreements/map-number-ratifications.png",
    "last_modified": "2021-12-18T22:30:02+01:00",
    "input_file": {},
    "preview_width": 7017,
    "preview_height": 4209
  },
  {
    "path": "posts/2021-01-27-watercolours/",
    "title": "Watercolours",
    "description": "A gallery displaying some of the artistic creations of Francesco and Lily",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      },
      {
        "name": "Lily Runkun Tian",
        "url": {}
      }
    ],
    "date": "2021-01-27",
    "categories": [
      "other"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\nClick on any picture to enlarge it\r\n\r\n\r\n\r\n\r\n\r\n#lightgallery > a > img:hover {\r\n   transform: scale(1.15, 1.15);\r\n   transition: 0.2s ease-in-out;\r\n   cursor: pointer;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    lightGallery(document.getElementById('lightgallery'));\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-01-27-watercolours/paintings/squirrel.jpeg",
    "last_modified": "2021-12-18T22:27:35+01:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-01-20-mappa-licita-naturale/",
    "title": "Mappa licita naturale",
    "description": "Mappa di un sistema di licita naturale lungo-corto a bridge",
    "author": [
      {
        "name": "Francesco S. Bellelli",
        "url": {}
      }
    ],
    "date": "2021-01-20",
    "categories": [
      "other"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\ndiv.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px; margin: auto; width: 50%}\r\n\r\n\r\nScaricare immagine: SVG\r\n\r\n\r\n\r\nVersione zoomabile\r\n\r\n\r\n\r\n\r\n* {box-sizing: border-box;}\r\n\r\n.img-zoom-container {\r\n  position: relative;\r\n}\r\n\r\n.img-zoom-lens {\r\n  position: absolute;\r\n  border: 1px solid #d4d4d4;\r\n  /*set the size of the lens:*/\r\n  width: 50px;\r\n  height: 50px;\r\n}\r\n\r\n.img-zoom-result {\r\n  border: 1px solid #d4d4d4;\r\n  /*set the size of the result div:*/\r\n  width: 500px;\r\n  height: 500px;\r\n}\r\n\r\n\r\n\r\nfunction imageZoom(imgID, resultID) {\r\n  var img, lens, result, cx, cy;\r\n  img = document.getElementById(imgID);\r\n  result = document.getElementById(resultID);\r\n  /* Create lens: */\r\n  lens = document.createElement(\"DIV\");\r\n  lens.setAttribute(\"class\", \"img-zoom-lens\");\r\n  /* Insert lens: */\r\n  img.parentElement.insertBefore(lens, img);\r\n  /* Calculate the ratio between result DIV and lens: */\r\n  cx = result.offsetWidth / lens.offsetWidth;\r\n  cy = result.offsetHeight / lens.offsetHeight;\r\n  /* Set background properties for the result DIV */\r\n  result.style.backgroundImage = \"url('\" + img.src + \"')\";\r\n  result.style.backgroundSize = (img.width * cx) + \"px \" + (img.height * cy) + \"px\";\r\n  /* Execute a function when someone moves the cursor over the image, or the lens: */\r\n  lens.addEventListener(\"mousemove\", moveLens);\r\n  img.addEventListener(\"mousemove\", moveLens);\r\n  /* And also for touch screens: */\r\n  lens.addEventListener(\"touchmove\", moveLens);\r\n  img.addEventListener(\"touchmove\", moveLens);\r\n  function moveLens(e) {\r\n    var pos, x, y;\r\n    /* Prevent any other actions that may occur when moving over the image */\r\n    e.preventDefault();\r\n    /* Get the cursor's x and y positions: */\r\n    pos = getCursorPos(e);\r\n    /* Calculate the position of the lens: */\r\n    x = pos.x - (lens.offsetWidth / 2);\r\n    y = pos.y - (lens.offsetHeight / 2);\r\n    /* Prevent the lens from being positioned outside the image: */\r\n    if (x > img.width - lens.offsetWidth) {x = img.width - lens.offsetWidth;}\r\n    if (x < 0) {x = 0;}\r\n    if (y > img.height - lens.offsetHeight) {y = img.height - lens.offsetHeight;}\r\n    if (y < 0) {y = 0;}\r\n    /* Set the position of the lens: */\r\n    lens.style.left = x + \"px\";\r\n    lens.style.top = y + \"px\";\r\n    /* Display what the lens \"sees\": */\r\n    result.style.backgroundPosition = \"-\" + (x * cx) + \"px -\" + (y * cy) + \"px\";\r\n  }\r\n  function getCursorPos(e) {\r\n    var a, x = 0, y = 0;\r\n    e = e || window.event;\r\n    /* Get the x and y positions of the image: */\r\n    a = img.getBoundingClientRect();\r\n    /* Calculate the cursor's x and y coordinates, relative to the image: */\r\n    x = e.pageX - a.left;\r\n    y = e.pageY - a.top;\r\n    /* Consider any page scrolling: */\r\n    x = x - window.pageXOffset;\r\n    y = y - window.pageYOffset;\r\n    return {x : x, y : y};\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nimageZoom(\"myimage\", \"myresult\");\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-01-20-mappa-licita-naturale/BRIDGE sistema naturale.svg",
    "last_modified": "2021-12-18T22:25:27+01:00",
    "input_file": {}
  }
]
